---
- id: snykio:packagist:moodle/moodle:174007
  title: Information Exposure
  description: |
    [moodle/moodle][1] is a learning platform.

    Affected versions of this package are vulnerable to Information
    Exposure. Permissions were not correctly checked before loading event
    information into the calendar\'s edit event modal popup, so logged in
    non-guest users could view unauthorised calendar events.



    [1]: https://packagist.org/packages/moodle/moodle
  affected_package: moodle/moodle
  vulnerable_versions:
  - ">=3.4.0  <3.4.8"
  - ">=3.5.0  <3.5.5"
  - ">=3.6.0  <3.6.3"
  severity: medium
  package_manager: packagist
  cve:
  - CVE-2019-3848
  cwe:
  - CWE-200
  disclosed_date: 2019-03-26
  created_date: 2019-03-26
  last_modified_date: 2019-03-26
  credit:
  - Juan Leyva
  references:
  - https://bugzilla.redhat.com/show_bug.cgi?id=CVE-2019-3848
  - https://moodle.org/mod/forum/discuss.php?d=384011#p1547743
  source_url: https://snyk.io/vuln/SNYK-PHP-MOODLEMOODLE-174007
- id: snykio:packagist:moodle/moodle:174012
  title: Security Issue
  description: |
    [moodle/moodle][1] is a learning platform.

    Affected versions of this package are vulnerable to Security Issue.
    Users with the \"login as other users\" permission (such as
    administrators/managers) can access other users\' Dashboards, but the
    JavaScript those other users may have added to their Dashboard was not
    being escaped when being viewed by the user logging in on their behalf.



    [1]: https://packagist.org/packages/moodle/moodle
  affected_package: moodle/moodle
  vulnerable_versions:
  - "<3.1.17"
  - ">=3.4.0  <3.4.8"
  - ">=3.5.0  <3.5.5"
  - ">=3.6.0  <3.6.3"
  severity: low
  package_manager: packagist
  cve:
  - CVE-2019-3847
  cwe:
  - CWE-355
  disclosed_date: 2019-03-27
  created_date: 2019-03-27
  last_modified_date: 2019-03-27
  credit:
  - Daniel Thatcher
  references:
  - http://git.moodle.org/gw?p=moodle.git&a=search&h=HEAD&st=commit&s=MDL-63786
  - https://bugzilla.redhat.com/show_bug.cgi?id=CVE-2019-3847
  - https://moodle.org/mod/forum/discuss.php?d=384010#p1547742
  source_url: https://snyk.io/vuln/SNYK-PHP-MOODLEMOODLE-174012
- id: snykio:packagist:moodle/moodle:174014
  title: Security Issue
  description: |
    [moodle/moodle][1] is a learning platform.

    Affected versions of this package are vulnerable to Security Issue.
    Links within assignment submission comments would open directly (in the
    same window). Although links themselves may be valid, opening within the
    same window and without the no-referrer header policy made them more
    susceptible to exploits.



    [1]: https://packagist.org/packages/moodle/moodle
  affected_package: moodle/moodle
  vulnerable_versions:
  - ">=3.1.0  <3.1.17"
  - ">=3.4.0  <3.4.8"
  - ">=3.5.0  <3.5.5"
  - ">=3.6.0  <3.6.3"
  severity: low
  package_manager: packagist
  cve:
  - CVE-2019-3850
  cwe:
  - CWE-355
  disclosed_date: 2019-03-26
  created_date: 2019-03-26
  last_modified_date: 2019-03-26
  credit:
  - Steeven George
  references:
  - http://git.moodle.org/gw?p=moodle.git;a=commitdiff;h=5d87464bc6283e72969cd251ce4f399aacebd608
  - https://bugzilla.redhat.com/show_bug.cgi?id=CVE-2019-3850
  - https://moodle.org/mod/forum/discuss.php?d=384013#p1547745
  source_url: https://snyk.io/vuln/SNYK-PHP-MOODLEMOODLE-174014
- id: snykio:packagist:moodle/moodle:174016
  title: Permissions Issues
  description: |
    [moodle/moodle][1] is a learning platform.

    Affected versions of this package are vulnerable to Permissions Issues.
    The `get_with_capability_join` and `get_users_by_capability` functions
    do not take context freezing into account when checking user
    capabilities.



    [1]: https://packagist.org/packages/moodle/moodle
  affected_package: moodle/moodle
  vulnerable_versions:
  - "<3.6.3"
  severity: medium
  package_manager: packagist
  cve:
  - CVE-2019-3852
  cwe:
  - CWE-264
  disclosed_date: 2019-03-26
  created_date: 2019-03-26
  last_modified_date: 2019-03-26
  credit:
  - Andrew Nicols
  references:
  - http://git.moodle.org/gw?p=moodle.git&a=search&h=HEAD&st=commit&s=MDL-64410
  - https://bugzilla.redhat.com/show_bug.cgi?id=CVE-2019-3852
  - https://moodle.org/mod/forum/discuss.php?d=384015#p1547748
  source_url: https://snyk.io/vuln/SNYK-PHP-MOODLEMOODLE-174016
- id: snykio:packagist:moodle/moodle:174018
  title: Permissions Issues
  description: |
    [moodle/moodle][1] is a learning platform.

    Affected versions of this package are vulnerable to Permissions Issues.
    There is a link to the homesite within the Boost theme\'s secure layout,
    meaning students can navigate out of the page.



    [1]: https://packagist.org/packages/moodle/moodle
  affected_package: moodle/moodle
  vulnerable_versions:
  - ">=3.5.0  <3.5.5"
  - ">=3.6.0  <3.6.3"
  severity: medium
  package_manager: packagist
  cve:
  - CVE-2019-3851
  cwe:
  - CWE-264
  disclosed_date: 2019-03-26
  created_date: 2019-03-26
  last_modified_date: 2019-03-26
  credit:
  - Luca Bösch
  - Martin von Löwis
  references:
  - http://git.moodle.org/gw?p=moodle.git&a=search&h=HEAD&st=commit&s=MDL-64706
  - https://bugzilla.redhat.com/show_bug.cgi?id=CVE-2019-3851
  - https://moodle.org/mod/forum/discuss.php?d=384014#p1547746
  source_url: https://snyk.io/vuln/SNYK-PHP-MOODLEMOODLE-174018
- id: snykio:packagist:moodle/moodle:174020
  title: Permissions Issue
  description: |
    [moodle/moodle][1] is a learning platform.

    Affected versions of this package are vulnerable to Permissions Issue.
    Users could assign themselves an escalated role within courses or
    content accessed via LTI, by modifying the request to the LTI publisher
    site.



    [1]: https://packagist.org/packages/moodle/moodle
  affected_package: moodle/moodle
  vulnerable_versions:
  - ">=3.4.0  <3.4.8"
  - ">=3.5.0  <3.5.5"
  - ">=3.6.0  <3.6.3"
  severity: medium
  package_manager: packagist
  cve:
  - CVE-2019-3849
  cwe:
  - CWE-264
  disclosed_date: 2019-03-26
  created_date: 2019-03-26
  last_modified_date: 2019-03-26
  credit:
  - Unknown
  references:
  - http://git.moodle.org/gw?p=moodle.git&a=search&h=HEAD&st=commit&s=MDL-62702
  - https://bugzilla.redhat.com/show_bug.cgi?id=CVE-2019-3849
  - https://moodle.org/mod/forum/discuss.php?d=384012#p1547744
  source_url: https://snyk.io/vuln/SNYK-PHP-MOODLEMOODLE-174020
- id: snykio:packagist:moodle/moodle:72009
  title: Arbitrary E-mail Header Injection
  description: |
    [moodle/moodle][1] is a learning platform designed to provide educators,
    administrators and learners with a single robust, secure and integrated
    system to create personalised learning environments.

    Affected versions of this package are vulnerable to Arbitrary Email
    Header Injection. An attacker may inject arbitrary e-mail headers via
    vectors involving a crafted (1) From: or (2) Sender: header.



    [1]: https://moodle.org/
  affected_package: moodle/moodle
  vulnerable_versions:
  - "<1.9.16"
  - ">=2.0.0  <2.0.7"
  - ">=2.1.0  <2.1.4"
  - ">=2.2.0  <2.2.1"
  severity: medium
  package_manager: packagist
  cve:
  - CVE-2012-0796
  cwe:
  - CWE-94
  disclosed_date: 2012-07-17
  created_date: 2018-02-11
  last_modified_date: 2018-02-11
  credit:
  - Simon Coggins
  references:
  - https://bugzilla.redhat.com/show_bug.cgi?id=783532
  - https://nvd.nist.gov/vuln/detail/CVE-2012-0796
  source_url: https://snyk.io/vuln/SNYK-PHP-MOODLEMOODLE-72009
- id: snykio:packagist:moodle/moodle:72012
  title: Information Exposure
  description: |
    [moodle/moodle][1] is a learning platform designed to provide educators,
    administrators and learners with a single robust, secure and integrated
    system to create personalised learning environments.

    Affected versions of this package are vulnerable to Information
    Exposure. Users may see quiz results when it is prohibited in the
    settings.



    [1]: https://packagist.org/packages/moodle/moodle
  affected_package: moodle/moodle
  vulnerable_versions:
  - ">= 3.1  <=3.1.9"
  - ">=3.2  <=3.2.6"
  - ">=3.3  <=3.3.3"
  - ">=3.4  <3.4.1"
  severity: medium
  package_manager: packagist
  cve:
  - CVE-2018-1044
  cwe:
  - CWE-200
  disclosed_date: 2018-01-22
  created_date: 2018-02-11
  last_modified_date: 2018-02-11
  credit:
  - Chirine Nassar
  references:
  - https://moodle.org/mod/forum/discuss.php?d=364383
  - https://nvd.nist.gov/vuln/detail/CVE-2018-1044
  source_url: https://snyk.io/vuln/SNYK-PHP-MOODLEMOODLE-72012
- id: snykio:packagist:moodle/moodle:72013
  title: Blacklist Bypass
  description: |
    [moodle/moodle][1] is a learning platform designed to provide educators,
    administrators and learners with a single robust, secure and integrated
    system to create personalised learning environments.

    Affected versions of this package are vulnerable to Blacklist Bypass. An
    attacker may bypass the hosts list with multiple A record hostnames.



    [1]: https://packagist.org/packages/moodle/moodle
  affected_package: moodle/moodle
  vulnerable_versions:
  - ">=3.2  <3.2.7"
  - ">=3.3  <3.3.4"
  - ">=3.4  <3.4.1"
  severity: medium
  package_manager: packagist
  cve:
  - CVE-2018-1043
  cwe:
  - CWE-289
  disclosed_date: 2018-01-22
  created_date: 2018-02-11
  last_modified_date: 2018-02-11
  credit:
  - Jordan Tomkinson
  references:
  - https://moodle.org/mod/forum/discuss.php?d=364382
  - https://nvd.nist.gov/vuln/detail/CVE-2018-1043
  source_url: https://snyk.io/vuln/SNYK-PHP-MOODLEMOODLE-72013
- id: snykio:packagist:moodle/moodle:72024
  title: Server Side Request Forgery (SSRF)
  description: |
    [moodle/moodle][1] is a learning platform designed to provide educators,
    administrators and learners with a single robust, secure and integrated
    system to create personalised learning environments.

    Affected versions of this package are vulnerable to Server Side Request
    Forgery (SSRF). By substituting the source URL in the filepicker AJAX
    request, authenticated users are able to retrieve and view any URL.



    [1]: https://github.com/moodle/moodle
  affected_package: moodle/moodle
  vulnerable_versions:
  - ">=3.1  <3.1.10"
  - ">=3.2  <3.2.7"
  - ">=3.3  <3.3.4"
  - ">=3.4  <3.4.1"
  severity: medium
  package_manager: packagist
  cve:
  - CVE-2018-1042
  cwe:
  - CWE-918
  disclosed_date: 2018-01-22
  created_date: 2018-02-12
  last_modified_date: 2018-02-12
  credit:
  - Thomas DeVoss
  references:
  - https://moodle.org/mod/forum/discuss.php?d=364381
  - https://nvd.nist.gov/vuln/detail/CVE-2018-1042
  - https://www.securityfocus.com/bid/102752
  source_url: https://snyk.io/vuln/SNYK-PHP-MOODLEMOODLE-72024
- id: snykio:packagist:moodle/moodle:72025
  title: Cross-site Scripting (XSS)
  description: |
    [moodle/moodle][1] is a learning platform designed to provide educators,
    administrators and learners with a single robust, secure and integrated
    system to create personalised learning environments.

    Affected versions of this package are vulnerable to Cross-site Scripting
    (XSS). An attacker may inject javascript in the event name in the
    calendar block.



    [1]: https://github.com/moodle/moodle
  affected_package: moodle/moodle
  vulnerable_versions:
  - ">=3.1  <3.1.10"
  - ">=3.2  <3.2.7"
  - ">=3.3  <3.3.4"
  severity: medium
  package_manager: packagist
  cve:
  - CVE-2018-1045
  cwe:
  - CWE-79
  disclosed_date: 2018-01-22
  created_date: 2018-02-12
  last_modified_date: 2018-02-12
  credit:
  - Rubens Brandao
  references:
  - https://moodle.org/mod/forum/discuss.php?d=364384
  - https://nvd.nist.gov/vuln/detail/CVE-2018-1045
  source_url: https://snyk.io/vuln/SNYK-PHP-MOODLEMOODLE-72025
- id: snykio:packagist:moodle/moodle:72073
  title: Information Exposure
  description: |
    [moodle/moodle][1] is a learning platform designed to provide educators,
    administrators and learners with a single robust, secure and integrated
    system to create personalised learning environments.

    Affected versions of this package are vulnerable to Information
    Exposure. Students can find out email addresses of other students in the
    same course. Using search on the Participants page, students could
    search email addresses of all participants regardless of email
    visibility. This allows enumerating and guessing emails of other
    students.



    [1]: https://github.com/moodle/moodle
  affected_package: moodle/moodle
  vulnerable_versions:
  - ">=3.1 <3.1.9"
  - ">=3.2 <3.2.6"
  - ">=3.3 <3.3.2"
  severity: medium
  package_manager: packagist
  cve:
  - CVE-2017-15110
  cwe:
  - CWE-200
  disclosed_date: 2017-11-21
  created_date: 2018-02-27
  last_modified_date: 2018-02-27
  credit:
  - Unknown
  references:
  - https://moodle.org/mod/forum/discuss.php?d=361784
  - https://nvd.nist.gov/vuln/detail/CVE-2017-15110
  - https://www.securityfocus.com/bid/101909
  source_url: https://snyk.io/vuln/SNYK-PHP-MOODLEMOODLE-72073
- id: snykio:packagist:moodle/moodle:72127
  title: Authentication Bypass
  description: |
    [moodle/moodle][1] is a learning platform designed to provide educators,
    administrators and learners with a single robust, secure and integrated
    system to create personalised learning environments.

    Affected versions of this package are vulnerable to Authentication
    Bypass. Unauthenticated users can trigger custom messages to admin via
    paypal enrol script. Paypal IPN callback script should only send error
    emails to admin after request origin was verified, otherwise admin email
    can be spammed.



    [1]: https://packagist.org/packages/moodle/moodle
  affected_package: moodle/moodle
  vulnerable_versions:
  - ">=3.1  <3.1.11"
  - ">=3.2  <3.2.8"
  - ">=3.3  <3.3.5"
  - ">=3.4  <3.4.2"
  severity: medium
  package_manager: packagist
  cve:
  - CVE-2018-1081
  cwe:
  - CWE-592
  disclosed_date: 2018-04-04
  created_date: 2018-04-17
  last_modified_date: 2018-04-17
  credit:
  - Unknown
  references:
  - https://moodle.org/mod/forum/discuss.php?d=367938
  - https://nvd.nist.gov/vuln/detail/CVE-2018-1081
  source_url: https://snyk.io/vuln/SNYK-PHP-MOODLEMOODLE-72127
- id: snykio:packagist:moodle/moodle:72128
  title: Authentication Bypass
  description: |
    [moodle/moodle][1] is a learning platform designed to provide educators,
    administrators and learners with a single robust, secure and integrated
    system to create personalised learning environments.

    Affected versions of this package are vulnerable to Authentication
    Bypass. If a user account using OAuth2 authentication method was once
    confirmed but later suspended, the user could still login to the site.



    [1]: https://packagist.org/packages/moodle/moodle
  affected_package: moodle/moodle
  vulnerable_versions:
  - ">=3.3  <3.3.5"
  - ">=3.4  <3.4.2"
  severity: high
  package_manager: packagist
  cve:
  - CVE-2018-1082
  cwe:
  - CWE-592
  disclosed_date: 2018-04-04
  created_date: 2018-04-17
  last_modified_date: 2018-04-17
  credit:
  - Unknown
  references:
  - https://moodle.org/mod/forum/discuss.php?d=367939
  - https://nvd.nist.gov/vuln/detail/CVE-2018-1082
  source_url: https://snyk.io/vuln/SNYK-PHP-MOODLEMOODLE-72128
- id: snykio:packagist:moodle/moodle:72152
  title: Arbitrary File Download
  description: |
    [moodle/moodle][1] is the world\'s open source learning platform.

    Affected versions of this package are vulnerable to Arbitrary File
    Download. Students who submitted assignments and exported it to
    portfolios can download any stored Moodle file by changing download URL.



    [1]: https://packagist.org/packages/moodle/moodle
  affected_package: moodle/moodle
  vulnerable_versions:
  - ">3.1.12"
  - ">=3.2.0  <3.2.9"
  - ">=3.3.0  <3.3.6"
  - ">=3.4.0  <3.4.3"
  severity: medium
  package_manager: packagist
  cve:
  - CVE-2018-1135
  cwe:
  - CWE-36
  disclosed_date: 2018-05-25
  created_date: 2018-05-29
  last_modified_date: 2018-05-29
  credit:
  - Unknown
  references:
  - https://moodle.org/mod/forum/discuss.php?d=371201
  source_url: https://snyk.io/vuln/SNYK-PHP-MOODLEMOODLE-72152
- id: snykio:packagist:moodle/moodle:72153
  title: Arbitrary Code Execution
  description: |
    [moodle/moodle][1] is the world\'s open source learning platform.

    Affected versions of this package are vulnerable to Arbitrary Code
    Execution. A Teacher creating a Calculated question can intentionally
    cause an eval injection on the server.



    [1]: https://packagist.org/packages/moodle/moodle
  affected_package: moodle/moodle
  vulnerable_versions:
  - "<3.1.12"
  - ">=3.2.0  <3.2.9"
  - ">=3.3.0  <3.3.6"
  - ">=3.4.0  <3.4.3"
  severity: high
  package_manager: packagist
  cve:
  - CVE-2018-1133
  cwe:
  - CWE-94
  disclosed_date: 2018-05-25
  created_date: 2018-05-29
  last_modified_date: 2018-05-29
  credit:
  - Unknown
  references:
  - https://moodle.org/mod/forum/discuss.php?d=371199
  - https://nvd.nist.gov/vuln/detail/CVE-2018-1133
  source_url: https://snyk.io/vuln/SNYK-PHP-MOODLEMOODLE-72153
- id: snykio:packagist:moodle/moodle:72154
  title: Arbitrary File Download
  description: |
    [moodle/moodle][1] is the world\'s open source learning platform.

    Affected versions of this package are vulnerable to Arbitrary File
    Download. Students who submitted assignments and exported them to
    portfolios can download any stored Moodle file by changing the download
    URL.



    [1]: https://packagist.org/packages/moodle/moodle
  affected_package: moodle/moodle
  vulnerable_versions:
  - "<3.1.12"
  - ">=3.2.0  <3.2.9"
  - ">=3.3.0  <3.3.6"
  - ">=3.4.0  <3.4.3"
  severity: medium
  package_manager: packagist
  cve:
  - CVE-2018-1134
  cwe:
  - CWE-36
  disclosed_date: 2018-05-25
  created_date: 2018-05-29
  last_modified_date: 2018-05-29
  credit:
  - Unknown
  references:
  - https://moodle.org/mod/forum/discuss.php?d=371200
  - https://nvd.nist.gov/vuln/detail/CVE-2018-1134
  source_url: https://snyk.io/vuln/SNYK-PHP-MOODLEMOODLE-72154
- id: snykio:packagist:moodle/moodle:72155
  title: Denial of Service (DDoS)
  description: |
    [moodle/moodle][1] is the world\'s open source learning platform.

    Affected versions of this package are vulnerable to Denial of Service
    (DoS) attacks. By substituting URLs in portfolios, users can instantiate
    any class. This can also be exploited by users who are logged in as
    guests to create a DDoS attack.



    [1]: https://packagist.org/packages/moodle/moodle
  affected_package: moodle/moodle
  vulnerable_versions:
  - "<3.1.12"
  - ">=3.2.0  <3.2.9"
  - ">=3.3.0  <3.3.6"
  - ">=3.4.0  <3.4.3"
  severity: high
  package_manager: packagist
  cve:
  - CVE-2018-1137
  cwe:
  - CWE-400
  disclosed_date: 2018-05-25
  created_date: 2018-05-29
  last_modified_date: 2018-05-29
  credit:
  - Unknown
  references:
  - https://moodle.org/mod/forum/discuss.php?d=371204
  - https://nvd.nist.gov/vuln/detail/CVE-2018-1137
  source_url: https://snyk.io/vuln/SNYK-PHP-MOODLEMOODLE-72155
- id: snykio:packagist:moodle/moodle:72250
  title: Information Exposure
  description: |
    [moodle/moodle][1] is an open source learning platform.

    Affected versions of this package are vulnerable to Information
    Exposure. It is impossible to omit logs from data privacy exports. Thus,
    the logs may contain details of other users who interacted with the
    requester.



    [1]: https://packagist.org/packages/moodle/moodle
  affected_package: moodle/moodle
  vulnerable_versions:
  - "<3.3.7"
  - ">=3.4.0  <3.4.4"
  - ">=3.5.0  <3.5.1"
  severity: medium
  package_manager: packagist
  cve:
  - CVE-2018-10889
  cwe:
  - CWE-200
  disclosed_date: 2018-07-10
  created_date: 2018-07-30
  last_modified_date: 2018-07-30
  credit:
  - Unknown
  references:
  - https://bugzilla.redhat.com/show_bug.cgi?id=CVE-2018-10889
  source_url: https://snyk.io/vuln/SNYK-PHP-MOODLEMOODLE-72250
- id: snykio:packagist:moodle/moodle:72251
  title: Information Exposure
  description: |
    [moodle/moodle][1] is an open source learning platform.

    Affected versions of this package are vulnerable to Information Exposure
    via the `core_course_get_categories` web service. It would return hidden
    categories, which should be omitted when fetching course categories.



    [1]: https://packagist.org/packages/moodle/moodle
  affected_package: moodle/moodle
  vulnerable_versions:
  - "<3.1.13"
  - ">=3.3.0  <3.3.7"
  - ">=3.4.0  <3.4.4"
  - ">=3.5.0  <3.5.1"
  severity: medium
  package_manager: packagist
  cve:
  - CVE-2018-10890
  cwe:
  - CWE-200
  disclosed_date: 2018-07-10
  created_date: 2018-07-30
  last_modified_date: 2018-07-30
  credit:
  - Unknown
  references:
  - https://bugzilla.redhat.com/show_bug.cgi?id=CVE-2018-10890
  source_url: https://snyk.io/vuln/SNYK-PHP-MOODLEMOODLE-72251
- id: snykio:packagist:moodle/moodle:72252
  title: Arbitrary Code Execution
  description: |
    [moodle/moodle][1] is an open source learning platform.

    Affected versions of this package are vulnerable to Arbitrary Code
    Execution. When a quiz question bank is imported, it was possible for
    the question preview that is displayed to execute JavaScript that is
    written into the question bank.



    [1]: https://packagist.org/packages/moodle/moodle
  affected_package: moodle/moodle
  vulnerable_versions:
  - "<3.1.13"
  - ">=3.3.0  <3.3.7"
  - ">=3.4.0  <3.4.4"
  - ">=3.5.0  <3.5.1"
  severity: high
  package_manager: packagist
  cve:
  - CVE-2018-10891
  cwe:
  - CWE-94
  disclosed_date: 2018-07-10
  created_date: 2018-07-30
  last_modified_date: 2018-07-30
  credit:
  - Unknown
  references:
  - https://bugzilla.redhat.com/show_bug.cgi?id=CVE-2018-10891
  source_url: https://snyk.io/vuln/SNYK-PHP-MOODLEMOODLE-72252
- id: snykio:packagist:moodle/moodle:72408
  title: Arbitrary Code Execution
  description: |
    [moodle/moodle][1] is an open source learning platform.

    Affected versions of this package are vulnerable to Arbitrary Code
    Execution. When importing legacy `drag and drop into text` type quiz
    questions, it was possible to inject and execute PHP code from within
    the imported questions, either intentionally or by importing questions
    from an untrusted source.



    [1]: https://packagist.org/packages/moodle/moodle
  affected_package: moodle/moodle
  vulnerable_versions:
  - "<3.1.14"
  - ">=3.3.0  <3.3.8"
  - ">=3.4.0  <3.4.5"
  - ">=3.5.0  <3.5.2"
  severity: high
  package_manager: packagist
  cve:
  - CVE-2018-14630
  cwe:
  - CWE-94
  disclosed_date: 2018-09-17
  created_date: 2018-09-27
  last_modified_date: 2018-09-27
  credit:
  - Unknown
  references:
  - https://bugzilla.redhat.com/show_bug.cgi?id=CVE-2018-14630
  source_url: https://snyk.io/vuln/SNYK-PHP-MOODLEMOODLE-72408
- id: snykio:packagist:moodle/moodle:72409
  title: Cross-site Scripting (XSS)
  description: |+
    [moodle/moodle][1] is an open source learning platform.

    Affected versions of this package are vulnerable to Cross-site Scripting
    (XSS) attacks via the search parameter.



    [1]: https://packagist.org/packages/moodle/moodle
    \nA cross-site scripting attack occurs when the attacker tricks a
    legitimate web-based application or site to accept a request as
    originating from a trusted source.

    This is done by escaping the context of the web application; the web
    application then delivers that data to its users along with other
    trusted dynamic content, without validating it. The browser unknowingly
    executes malicious script on the client side (through client-side
    languages; usually JavaScript or HTML) in order to perform actions that
    are otherwise typically blocked by the browser’s Same Origin Policy.

    ֿInjecting malicious code is the most prevalent manner by which XSS is
    exploited; for this reason, escaping characters in order to prevent this
    manipulation is the top method for securing code against this
    vulnerability.

    Escaping means that the application is coded to mark key characters, and
    particularly key characters included in user input, to prevent those
    characters from being interpreted in a dangerous context. For example,
    in HTML, `<` can be coded as `&lt`; and `>` can be coded as `&gt`; in
    order to be interpreted and displayed as themselves in text, while
    within the code itself, they are used for HTML tags. If malicious
    content is injected into an application that escapes special characters
    and that malicious content uses `<` and `>` as HTML tags, those
    characters are nonetheless not interpreted as HTML tags by the browser
    if they’ve been correctly escaped in the application code and in this
    way the attempted attack is diverted.

    The most prominent use of XSS is to steal cookies (source: OWASP
    HttpOnly) and hijack user sessions, but XSS exploits have been used to
    expose sensitive information, enable access to privileged services and
    functionality and deliver malware.

    ### Types of attacks   {#types-of-attacks}

    There are a few methods by which XSS can be manipulated:

    | Type | Origin | Description |
    |----------
    | **Stored** | Server | The malicious code is inserted in the application (usually as a link) by the attacker. The code is activated every time a user clicks the link. |
    | **Reflected** | Server | The attacker delivers a malicious link externally from the vulnerable web site application to a user. When clicked, malicious code is sent to the vulnerable web site, which reflects the attack back to the user’s browser. |
    | **DOM-based** | Client | The attacker forces the user’s browser to render a malicious page. The data in the page itself delivers the cross-site scripting data. |
    | **Mutated** |  | The attacker injects code that appears safe, but is then rewritten and modified by the browser, while parsing the markup. An example is rebalancing unclosed quotation marks or even adding quotation marks to unquoted parameters. |

    ### Affected environments   {#affected-environments}

    The following environments are susceptible to an XSS attack:

    * Web servers
    * Application servers
    * Web application environments

    ### How to prevent   {#how-to-prevent}

    This section describes the top best practices designed to specifically
    protect your code:

    * Sanitize data input in an HTTP request before reflecting it back,
      ensuring all data is validated, filtered or escaped before echoing
      anything back to the user, such as the values of query parameters
      during searches.
    * Convert special characters such as `?`, `&`, `/`, `<`, `>` and spaces
      to their respective HTML or URL encoded equivalents.
    * Give users the option to disable client-side scripts.
    * Redirect invalid requests.
    * Detect simultaneous logins, including those from two separate IP
      addresses, and invalidate those sessions.
    * Use and enforce a Content Security Policy (source: Wikipedia) to
      disable any features that might be manipulated for an XSS attack.
    * Read the documentation for any of the libraries referenced in your
      code to understand which elements allow for embedded HTML.

  affected_package: moodle/moodle
  vulnerable_versions:
  - "<3.3.8"
  - ">=3.4.0  <3.4.5"
  - ">=3.5.0  <3.5.2"
  severity: medium
  package_manager: packagist
  cve:
  - CVE-2018-14631
  cwe:
  - CWE-79
  disclosed_date: 2018-09-17
  created_date: 2018-09-27
  last_modified_date: 2018-09-27
  credit:
  - Unknown
  references:
  - https://bugzilla.redhat.com/show_bug.cgi?id=CVE-2018-14631
  source_url: https://snyk.io/vuln/SNYK-PHP-MOODLEMOODLE-72409
- id: snykio:packagist:moodle/moodle:72639
  title: Cross-site Request Forgery (CSRF)
  description: |
    [moodle/moodle][1] is an open source learning platform.

    Affected versions of this package are vulnerable to Cross-site Request
    Forgery. The login form was not protected by a token to prevent login
    CSRF.



    [1]: https://packagist.org/packages/moodle/moodle
  affected_package: moodle/moodle
  vulnerable_versions:
  - "<3.1.15"
  - ">=3.2.0  <3.3.9"
  - ">=3.4.0  <3.4.6"
  - ">=3.5.0  <3.5.3"
  severity: medium
  package_manager: packagist
  cve:
  - CVE-2018-16854
  cwe:
  - CWE-352
  disclosed_date: 2018-11-26
  created_date: 2018-11-28
  last_modified_date: 2018-11-28
  credit:
  - Unknown
  references:
  - https://bugzilla.redhat.com/show_bug.cgi?id=CVE-2018-16854
  source_url: https://snyk.io/vuln/SNYK-PHP-MOODLEMOODLE-72639
