---
- id: snykio:packagist:dariusiii/zipper:552163
  title: Arbitrary File Write via Archive Extraction (Zip Slip)
  description: "[dariusiii/zipper][1] is a Simple Wrapper around the ZipArchive methods\nwith
    some handy functions. This package is an updated fork of\nChumper/Zipper.\n\nAffected
    versions of this package are vulnerable to Arbitrary File Write\nvia Archive Extraction
    (Zip Slip). ZIP Path traversal is possible during\nextraction due to no validation
    and sanitization of filenames.\n\n### PoC by Snyk   {#poc-by-snyk}\n\n    <?php\n
    \   require __DIR__ . '/vendor/autoload.php';\n    $zipper = new \\Chumper\\Zipper\\Zipper;\n
    \   \n    $zipper->make('/archives/zip-slip.zip')->extractTo('/uploads');\n    $zipper->close();\n\n\n\n[1]:
    https://github.com/DariusIII/Zipper\n\\nIt is exploited using a specially crafted
    zip archive, that holds path\ntraversal filenames. When exploited, a filename
    in a malicious archive\nis concatenated to the target extraction directory, which
    results in the\nfinal path ending up outside of the target folder. For instance,
    a zip\nmay hold a file with a \\\"../../file.exe\\\" location and thus break out
    of\nthe target folder. If an executable or a configuration file is\noverwritten
    with a file containing malicious code, the problem can turn\ninto an arbitrary
    code execution issue quite easily.\n\nThe following is an example of a zip archive
    with one benign file and\none malicious file. Extracting the malicous file will
    result in\ntraversing out of the target folder, ending up in `/root/.ssh/`\noverwriting
    the `authorized_keys` file:\n\n    \n    +2018-04-15 22:04:29 ..... 19 19 good.txt\n
    \   \n    +2018-04-15 22:04:42 ..... 20 20 ../../../../../../root/.ssh/authorized_keys\n\n"
  affected_package: dariusiii/zipper
  vulnerable_versions:
  - "<2.0.2"
  severity: high
  package_manager: packagist
  cwe:
  - CWE-29
  disclosed_date: 2020-02-25
  created_date: 2020-02-25
  last_modified_date: 2020-02-25
  credit:
  - Snyk Security Team
  references:
  - https://github.com/Chumper/Zipper/commit/d15207e010f8fe1bdd341376bd86d599c4166423
  - https://github.com/DariusIII/Zipper/commit/c7f97c9d60caf5fbb0227b7639993566d60ab96e
  - https://github.com/madnest/madzipper/commit/13d2f1a68518545a2338458a8b95175aaec67768
  source_url: https://snyk.io/vuln/SNYK-PHP-DARIUSIIIZIPPER-552163
