---
- id: friendsofphp:packagist:silverstripe/graphql:CVE-2019-12437
  title: 'CVE-2019-12437: Cross Site Request Forgery (CSRF) Protection Bypass in GraphQL'
  affected_package: silverstripe/graphql
  vulnerable_versions:
  - ">=2.0.0 <2.0.5"
  - ">=3.0.0 <3.1.2"
  - ">=3.1.0 <3.1.2"
  package_manager: packagist
  cve:
  - CVE-2019-12437
  disclosed_date: 2019-06-11
  created_date: 2019-06-11
  last_modified_date: 2019-06-11
  credit:
  - FriendsOfPHP
  references:
  - https://www.silverstripe.org/download/security-releases/cve-2019-12437
  source_url: https://github.com/FriendsOfPHP/security-advisories/blob/master/silverstripe/graphql/CVE-2019-12437.yaml
- id: friendsofphp:packagist:silverstripe/graphql:SS-2018-007-1
  title: 'SS-2018-007: CSRF vulnerability in graphql'
  affected_package: silverstripe/graphql
  vulnerable_versions:
  - ">=2.0.0 <2.0.3"
  package_manager: packagist
  disclosed_date: 2018-12-10
  created_date: 2018-12-10
  last_modified_date: 2018-12-10
  credit:
  - FriendsOfPHP
  references:
  - https://www.silverstripe.org/download/security-releases/ss-2018-007/
  source_url: https://github.com/FriendsOfPHP/security-advisories/blob/master/silverstripe/graphql/SS-2018-007-1.yaml
- id: snykio:packagist:silverstripe/graphql:546525
  title: Cross-site Request Forgery (CSRF)
  description: |
    [silverstripe/graphql][1] is a GraphQL server for SilverStripe models
    and other data.

    Affected versions of this package are vulnerable to Cross-site Request
    Forgery (CSRF). The GraphQL controller lacks any CSRF protection,
    meaning authenticated users can be forced or tricked into visiting a URL
    that would send a GET request to the affected web server that could
    mutate or destroy data without the user knowing.



    [1]: https://packagist.org/packages/silverstripe/graphql
  affected_package: silverstripe/graphql
  vulnerable_versions:
  - ">=2.0.0  <2.0.3"
  severity: high
  package_manager: packagist
  cwe:
  - CWE-352
  disclosed_date: 2020-02-05
  created_date: 2020-02-05
  last_modified_date: 2020-02-05
  credit:
  - Mustafa Hasan
  references:
  - https://www.silverstripe.org/download/security-releases/ss-2018-007/
  source_url: https://snyk.io/vuln/SNYK-PHP-SILVERSTRIPEGRAPHQL-546525
- id: snykio:packagist:silverstripe/graphql:550160
  title: Cross-site Request Forgery (CSRF)
  description: |
    [silverstripe/graphql][1] is a GraphQL server for SilverStripe models
    and other data.

    Affected versions of this package are vulnerable to Cross-site Request
    Forgery (CSRF). The code change that implements Cross Site Request
    Forgery (CSRF) protection on GraphQL mutation queries does not
    adequately protect users against CSRF attacks on GraphQL endpoints. A
    GraphQL query formed with a fragment portion before the mutation would
    bypass the check for determining whether the query is a mutation and
    therefore the `X-CSRF-TOKEN HTTP` header is not required to be supplied
    with the HTTP request.



    [1]: https://packagist.org/packages/silverstripe/graphql
  affected_package: silverstripe/graphql
  vulnerable_versions:
  - ">=2.0.0  <2.0.5"
  - ">=3.0.0  <3.1.0"
  severity: medium
  package_manager: packagist
  cve:
  - CVE-2019-12437
  cwe:
  - CWE-352
  disclosed_date: 2020-02-19
  created_date: 2020-02-19
  last_modified_date: 2020-02-19
  credit:
  - Unknown
  references:
  - https://www.silverstripe.org/blog/tag/release
  - https://www.silverstripe.org/download/security-releases/
  source_url: https://snyk.io/vuln/SNYK-PHP-SILVERSTRIPEGRAPHQL-550160
- id: snykio:packagist:silverstripe/graphql:584900
  title: Improper Input Validation
  description: |
    [silverstripe/graphql][1] is a GraphQL server for SilverStripe models
    and other data.

    Affected versions of this package are vulnerable to Improper Input
    Validation. The automatic permission checking mechanism in the
    silverstripe/graphql module does not provide complete protection against
    lists that are limited (e.g. through pagination), resulting in records
    that should fail the permission check being added to the final result
    set.

    GraphQL endpoints are configured by default through the CMS (e.g. for
    assets), but the admin/graphql endpoint is access protected by default.
    This limits the vulnerability to users with access to the CMS, but still
    applies when those authenticated users have limited permissions (e.g.
    where viewing records exposed through admin/graphql require
    administrator permissions).

    Where custom GraphQL endpoints have been be configured for a specific
    implementation (usually under /graphql), this vulnerability could also
    be exploited through unauthenticated requests.

    This vulnerability only applies for reading records it does not allow
    unauthorised changing of records.



    [1]: https://packagist.org/packages/silverstripe/graphql
  affected_package: silverstripe/graphql
  vulnerable_versions:
  - ">=3.2.0  <3.2.4"
  severity: medium
  package_manager: packagist
  cve:
  - CVE-2020-6165
  cwe:
  - CWE-20
  disclosed_date: 2020-07-16
  created_date: 2020-07-16
  last_modified_date: 2020-07-16
  credit:
  - CEO
  - Matthias Leutenegger
  - Syntro GmbH and Rob Ingram
  references:
  - https://www.silverstripe.org/download/security-releases/cve-2020-6165
  source_url: https://snyk.io/vuln/SNYK-PHP-SILVERSTRIPEGRAPHQL-584900
