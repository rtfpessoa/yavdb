---
- id: snykio:pypi:datasette:598229
  title: Information Exposure
  description: |
    [datasette][1] is an An open source multi-tool for exploring and
    publishing data

    Affected versions of this package are vulnerable to Information
    Exposure. The HTML form for a read-only canned query includes the hidden
    CSRF token field for writable canned queries. Submitting those read-only
    forms exposes the CSRF token in the URL - for example:
    `https://latest.datasette.io/fixtures/neighborhood_search?text=down&csrftoken=CSRFTOKEN-HERE`.
    This token could potentially leak to an attacker if the resulting page
    has a link to an external site on it and the user clicks the link, since
    the token would be exposed in the referral logs.



    [1]: https://www.pypi.org/project/datasette
  affected_package: datasette
  vulnerable_versions:
  - "< 0.46"
  severity: medium
  package_manager: pypi
  cwe:
  - CWE-200
  disclosed_date: 2020-08-11
  created_date: 2020-08-12
  last_modified_date: 2020-08-12
  credit:
  - Unknown
  references:
  - https://github.com/simonw/datasette/commit/7f10f0f7664d474c1be82bf668829e3b736a3d2b
  - https://github.com/simonw/datasette/issues/918
  source_url: https://snyk.io/vuln/SNYK-PYTHON-DATASETTE-598229
