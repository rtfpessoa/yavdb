---
- id: snykio:pypi:platformio:568834
  title: Arbitrary File Write via Archive Extraction (Zip Slip)
  description: "[platformio][1] is a new generation ecosystem for embedded development.\nCross-platform
    IDE and Unified Debugger. Static Code Analyzer and Remote\nUnit Testing. Multi-platform
    and Multi-architecture Build System.\nFirmware File Explorer and Memory Inspection.
    Arduino, ARM mbed,\nEspressif (ESP8266/ESP32), STM32, PIC32, nRF51/nRF52, RISC-V,
    FPGA,\nCMSIS, SPL, AVR, Samsung ARTIK, libOpenCM3.\n\nAffected versions of this
    package are vulnerable to Arbitrary File Write\nvia Archive Extraction (Zip Slip).
    It is possible to overwrite files\nwhen using `FileUnpacker` to extract items
    from TAR archive.\n\n\n\n[1]: https://www.pypi.org/project/platformio\n\\nIt is
    exploited using a specially crafted zip archive, that holds path\ntraversal filenames.
    When exploited, a filename in a malicious archive\nis concatenated to the target
    extraction directory, which results in the\nfinal path ending up outside of the
    target folder. For instance, a zip\nmay hold a file with a \\\"../../file.exe\\\"
    location and thus break out of\nthe target folder. If an executable or a configuration
    file is\noverwritten with a file containing malicious code, the problem can turn\ninto
    an arbitrary code execution issue quite easily.\n\nThe following is an example
    of a zip archive with one benign file and\none malicious file. Extracting the
    malicous file will result in\ntraversing out of the target folder, ending up in
    `/root/.ssh/`\noverwriting the `authorized_keys` file:\n\n    \n    +2018-04-15
    22:04:29 ..... 19 19 good.txt\n    \n    +2018-04-15 22:04:42 ..... 20 20 ../../../../../../root/.ssh/authorized_keys\n\n"
  affected_package: platformio
  vulnerable_versions:
  - "< 4.1.0"
  severity: high
  package_manager: pypi
  cwe:
  - CWE-29
  disclosed_date: 2019-10-24
  created_date: 2020-05-12
  last_modified_date: 2020-05-12
  credit:
  - Unknown
  references:
  - https://github.com/platformio/platformio-core/commit/798b12ce7b097fdcb5056d84054fe157aa12a9ff
  - https://github.com/platformio/platformio-core/issues/2995
  source_url: https://snyk.io/vuln/SNYK-PYTHON-PLATFORMIO-568834
