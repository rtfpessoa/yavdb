---
- id: npmjs:npm:unzipper:680
  title: Arbitrary File Write via Archive Extraction
  description: Versions of `unzipper` before 0.8.13 are vulnerable to arbitrary file
    write when used to extract a specifically crafted archive that contains path traversal
    filenames (`../../file.txt` for example).
  affected_package: unzipper
  vulnerable_versions:
  - "<0.8.13"
  severity: high
  package_manager: npm
  cve:
  - CVE-2018-1002203
  cwe: CWE-29
  disclosed_date: 1970-01-01
  created_date: 1970-01-01
  last_modified_date: 1970-01-01
  credit: snyk security team
  references: https://npmjs.com/advisories/680
  source_url: https://npmjs.com/advisories/680
- id: snykio:npm:unzipper:20180415
  title: Arbitrary File Write via Archive Extraction (Zip Slip)
  description: "[`unzipper`][1] is an Unzip cross-platform streaming API.\n\nAffected
    versions of the package are vulnerable to Arbitrary File Write\nvia Archive Extraction
    (AKA \\\"Zip Slip\\\").\n\nIt is exploited using a specially crafted zip archive,
    that holds path\ntraversal filenames. When exploited, a filename in a malicious
    archive\nis concatenated to the target extraction directory, which results in
    the\nfinal path ending up outside of the target folder. For instance, a zip\nmay
    hold a file with a \\\"../../file.exe\\\" location and thus break out of\nthe
    target folder. If an executable or a configuration file is\noverwritten with a
    file containing malicious code, the problem can turn\ninto an arbitrary code execution
    issue quite easily.\n\nThe following is an example of a zip archive with one benign
    file and\none malicious file. Extracting the malicous file will result in\ntraversing
    out of the target folder, ending up in `/root/.ssh/`\noverwriting the `authorized_keys`
    file:\n\n    \n    +2018-04-15 22:04:29 ..... 19 19 good.txt\n    \n    +2018-04-15
    22:04:42 ..... 20 20 ../../../../../../root/.ssh/authorized_keys\n\n\n\n[1]: https://www.npmjs.com/package/unzipper\n"
  affected_package: unzipper
  vulnerable_versions:
  - "<0.8.13"
  severity: high
  package_manager: npm
  cve:
  - CVE-2018-1002203
  cwe:
  - CWE-29
  disclosed_date: 2018-04-14
  created_date: 2018-05-31
  last_modified_date: 2018-05-31
  credit:
  - Snyk Security Research Team
  references:
  - https://github.com/snyk/zip-slip-vulnerability
  - https://github.com/ZJONSSON/node-unzipper/pull/59
  - https://github.com/ZJONSSON/node-unzipper/pull/59/commits/5f68901c2e2e062a5e0083a81d257eccea0eb760
  - https://hackerone.com/reports/362119
  - https://snyk.io/research/zip-slip-vulnerability
  source_url: https://snyk.io/vuln/npm:unzipper:20180415
