---
- id: npmjs:npm:mobile-icon-resizer:317
  title: Arbitrary Code Injection
  description: |-
    mobile-icon-resizer resizes large images for use as icons for iOS and Android.

    mobile-icon-resizer has a code execution vulnerability in versions before 0.4.3.

    mobile-icon-resizer takes an options object as an argument to define the resulting icons as such:
    ```
    var options = {
      config: './config.js'
    }
    resize(options, function(err){});
    ```
    config.js would need to be a file on the filesystem and look something like:
    ```
    var config = {
      iOS: {
        "images": [
         /* iOS image definitions are not vulnerable */
        ]
      },
      android: {
        "images" : [
          {
            "baseRatio" : "console.log('Executing script as baseRatio property')",
            "folder" : "drawable-ldpi"
          },
          {
            "ratio" : "console.log('Executing script as ratio property')",
            "folder" : "drawable-mdpi"
          },
        /* other android image defintiions ... */
        ]
      }
    };

    exports = module.exports = config;
    ```
    The parameters `ratio` and `baseRatio` are passed directly to `eval()`, thus allowing dynamic javascript payloads to be executed.
  affected_package: mobile-icon-resizer
  vulnerable_versions:
  - ">=0.2.0 <=0.4.2"
  severity: high
  package_manager: npm
  cwe: CWE-94
  disclosed_date: 1970-01-01
  created_date: 1970-01-01
  last_modified_date: 1970-01-01
  credit: Cristian-Alexandru Staicu
- id: ossindex:npm:mobile-icon-resizer:8405001219
  title: Code execution
  description: Arbitrary code injection is possible when input is passed directly
    to an invocation of `eval`.
  affected_package: mobile-icon-resizer
  vulnerable_versions:
  - "<0.4.3"
  package_manager: npm
  disclosed_date: 2017-07-31
  created_date: 2017-07-31
  last_modified_date: 2017-07-31
  credit:
  - OSSIndex
  references:
  - https://github.com/muzzley/mobile-icon-resizer/commit/a6c50f884bd282d74ab77e1fce6317d5d0dd2f0f
  - https://github.com/muzzley/mobile-icon-resizer/issues/8
  source_url: https://ossindex.net/resource/package/7014137459/vulnerabilities
- id: snykio:npm:mobile-icon-resizer:20160408
  title: Arbitrary Code Injection
  description: |
    [`mobile-icon-resizer`][1] is a tool used to resize iOS and Android
    application icons in batch.

    Affected versions of the package are vulnerable to Arbitrary Code
    Injection due to unsafe use of the `eval()` function. Node.js provides
    the `eval()` function by default, and is used to translate strings into
    Javascript code. An attacker can craft a malicious payload to inject
    arbitrary commands.



    [1]: https://www.npmjs.com/package/mobile-icon-resizer
  affected_package: mobile-icon-resizer
  vulnerable_versions:
  - "<0.4.3"
  severity: medium
  package_manager: npm
  cwe:
  - CWE-94
  disclosed_date: 2016-04-08
  created_date: 2017-05-01
  last_modified_date: 2017-05-01
  credit:
  - Ben Livshits
  - CristianAlexandru Staicu
  - Michael Pradel
  references:
  - http://wp.internetsociety.org/ndss/wp-content/uploads/sites/25/2018/02/ndss2018_07A-2_Staicu_paper.pdf
  - https://github.com/muzzley/mobile-icon-resizer/commit/a6c50f884bd282d74ab77e1fce6317d5d0dd2f0f
  - https://github.com/muzzley/mobile-icon-resizer/issues/8
  source_url: https://snyk.io/vuln/npm:mobile-icon-resizer:20160408
