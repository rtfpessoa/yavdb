---
- id: npmjs:npm:anarchy:1089
  title: Malicious Package
  description: All versions of `anarchy` contain malicious code. The package ran `rm
    - rf /` as an install script.
  affected_package: anarchy
  vulnerable_versions:
  - ">=0.0.0"
  severity: high
  package_manager: npm
  cwe: CWE-506
  disclosed_date: 1970-01-01
  created_date: 1970-01-01
  last_modified_date: 1970-01-01
  credit: Ruian Duan
- id: snykio:npm:anarchy:20170917
  title: Malicious Package
  description: |+
    `anarchy` is a malicious package that was used to collect download
    metrics beyond what npm provides, and sent them to google analytics or
    piwik. This can cause a privacy concern amongst users.

    This is especially dangerous in production runtime environments, where
    environment variables tend to consist of keys, passwords, tokens and
    other secrets.

    Example:

        {
          "name": "npm_scripts_test_metrics",
          "scripts": {
            "preinstall": "curl 'http://google-analytics.com/collect?v=1&t=event&tid=....'",
            "postinstall": "curl 'http://google-analytics.com/collect?v=1&t=event&tid=....'"
          }
        },
        {
          "name": "subtitles-lib",
          "scripts": {
            "postinstall": "bash -c 'curl \"http://*****.piwikpro.com/piwik.php?idsite=3&rec=1&action_name=$HOSTNAME\"'"
          }
        }
    {: .language-json}

    The list of packages and their scripts are:

        npm_scripts_test_metrics
        subtitles-lib
        ikst
        botbait
        mktmpio
        anarchy

  affected_package: anarchy
  vulnerable_versions:
  - "*"
  severity: high
  package_manager: npm
  cwe:
  - CWE-506
  disclosed_date: 2017-08-08
  created_date: 2017-09-17
  last_modified_date: 2017-09-17
  credit:
  - Jordan Wright
  references:
  - https://duo.com/blog/hunting-malicious-npm-packages/
  source_url: https://snyk.io/vuln/npm:anarchy:20170917
