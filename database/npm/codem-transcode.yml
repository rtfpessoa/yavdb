---
- id: npmjs:npm:codem-transcode:2
  title: Potential Command Injection
  description: |-
    When the ffprobe functionality is enabled on the server, HTTP POST requests can be made to /probe. These requests are passed to the ffprobe binary on the server. Through this HTTP endpoint it is possible to send a malformed source file name to ffprobe that results in arbitrary command execution.

    ### Mitigating Factors:
    The ffprobe functionality is not enabled by default. In addition, exploitation opportunities are limited in a standard configuration because the server binds to the local interface by default.
  affected_package: codem-transcode
  vulnerable_versions:
  - "<0.5.0"
  severity: high
  package_manager: npm
  cve:
  - CVE-2013-7377
  cwe: CWE-77
  disclosed_date: 1970-01-01
  created_date: 1970-01-01
  last_modified_date: 1970-01-01
  credit: Neal Poole
- id: ossindex:npm:codem-transcode:8267157179
  title: Command injection
  description: When the ffprobe functionality is enabled, POST requests to /probe
    could be used as a vector for command execution.
  affected_package: codem-transcode
  vulnerable_versions:
  - "<0.5.0"
  package_manager: npm
  disclosed_date: 2016-05-21
  created_date: 2016-05-21
  last_modified_date: 2017-01-25
  credit:
  - OSSIndex
  references:
  - https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2013-7377
  - https://nodesecurity.io/advisories/2
  - https://nodesecurity.io/advisories/codem-transcode_command_injection
  source_url: https://ossindex.net/resource/package/7012202276/vulnerabilities
- id: snykio:npm:codem-transcode:20130707
  title: Arbitrary Command Injection
  description: |+
    The `codem-transcode` package supports a feature (off by default) to
    interact with a local `ffprobe`. When enabled, POST requests to `/probe`
    trigger the execution of the local `ffprobe` binary, with the provided
    parameters.

    This execution is done using `exec`, allowing piped requests, and
    therefore enabling remote command execution. Newer versions use
    `execFile` instead, preventing such injection (though still giving
    attackers to whatever functionality `ffprobe` supports, and any
    weaknesses in it).

    Note that, by default, the package only listens for such requests from
    the local network interface, greatly reducing the likelihood of
    exploitation.

  affected_package: codem-transcode
  vulnerable_versions:
  - "<0.5.0"
  severity: medium
  package_manager: npm
  cve:
  - CVE-2013-7377
  cwe:
  - CWE-77
  disclosed_date: 2013-07-07
  created_date: 2013-07-07
  last_modified_date: 2013-07-07
  credit:
  - Neal Poole
  references:
  - https://dzone.com/articles/understanding-execfile-spawn-exec-and-fork-in-node
  - https://github.com/madebyhiro/codem-transcode/commit/477aac9da7aab5d3f661ef4c0bf4accae5dff292
  source_url: https://snyk.io/vuln/npm:codem-transcode:20130707
