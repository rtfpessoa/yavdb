---
- id: npmjs:npm:bestzip:1554
  title: Command Injection
  description: |-
    Versions of `bestzip` prior to 2.1.7 are vulnerable to Command Injection. The package fails to sanitize input rules and passes it directly to an `exec` call on the `zip` function . This may allow attackers to execute arbitrary code in the system as long as the values of `destination` is user-controlled. This only affects users with a native `zip` command available. The following examples demonstrate the issue from the CLI and also programatically:
    - `bestzip test.zip 'sourcefile; mkdir folder'`
    - `zip({ source: 'sourcefile', destination: './test.zip; mkdir folder' })`
  affected_package: bestzip
  vulnerable_versions:
  - "<2.1.7"
  severity: high
  package_manager: npm
  cwe: CWE-78
  disclosed_date: 1970-01-01
  created_date: 1970-01-01
  last_modified_date: 1970-01-01
  credit: Konrad Linkowski
- id: snykio:npm:bestzip:609371
  title: Command Injection
  description: |
    [bestzip][1] is an Uses OS zip command if avaliable (for better
    performance and speed) or node.js version if there is no system command
    avaliable. Can be called via node or command line.

    Affected versions of this package are vulnerable to Command Injection
    via the `options` param.



    [1]: https://www.npmjs.com/package/bestzip
  affected_package: bestzip
  vulnerable_versions:
  - "<2.1.7"
  severity: high
  package_manager: npm
  cve:
  - CVE-2020-7730
  cwe:
  - CWE-78
  disclosed_date: 2020-09-02
  created_date: 2020-09-02
  last_modified_date: 2020-09-02
  credit:
  - Nathan Friedly
  references:
  - https://github.com/nfriedly/node-bestzip/commit/45d4a901478c6a8f396c8b959dd6cf8fd3f955b6
  source_url: https://snyk.io/vuln/SNYK-JS-BESTZIP-609371
