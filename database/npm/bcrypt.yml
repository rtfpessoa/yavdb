---
- id: ossindex:npm:bcrypt:8402207863
  title: Comparator possibly vulnerable to timing attacks.
  description: The comparison functions were using `strcmp` which compares each character
    at a time checking for non-matches, returning on the first non-match. This allows
    for a timing attack.
  affected_package: bcrypt
  vulnerable_versions:
  - "<0.2.2"
  package_manager: npm
  disclosed_date: 2016-11-30
  created_date: 2016-11-30
  last_modified_date: 2016-12-06
  credit:
  - OSSIndex
  references:
  - https://github.com/kelektiv/node.bcrypt.js/commit/71b67202e2305e7d8f618e599a894188c18d6a7f
  - https://github.com/ncb000gt/node.bcrypt.js/issues/13
  source_url: https://ossindex.net/resource/package/7012115486/vulnerabilities
- id: snykio:npm:bcrypt:174521
  title: Timing Attack
  description: "[bcrypt][1] is a A library to help you hash passwords.\n\nAffected
    versions of this package are vulnerable to Timing Attack. The\n`CompareStrings`
    function is not timing safe. Comparisons with a\ndifferent length of string have
    very different execution times. Even\nwith the same length of string, comparisons
    of matching strings run\nfaster than comparisons of different strings. This is
    due to the use of\na comparison statement (`if`) when evaluating strings, which
    results in\ndifferent outcomes dependent on the evaluation.\n\n    NAN_INLINE
    bool CompareStrings(const char* s1, const char* s2) {\n        bool eq = true;\n
    \       int s1_len = strlen(s1);\n        int s2_len = strlen(s2);\n    \n        //
    UNSAFE: This executes different instructions for a different length of string\n
    \       if (s1_len != s2_len) {\n            eq = false;\n        }\n    \n        const
    int max_len = (s2_len < s1_len) ? s1_len : s2_len;\n    \n        for (int i =
    0; i < max_len; ++i) {\n          // UNSAFE: s1 and s2 are only referenced if
    the index is valid (different instructions executed for different length of string)\n
    \         if (s1_len >= i && s2_len >= i && s1[i] != s2[i]) {\n            //
    UNSAFE: This instruction is only executed if the bytes are different\n            eq
    = false;\n          }\n        }\n    \n        return eq;\n    }\n\n\n\n[1]:
    https://www.npmjs.com/package/bcrypt\n"
  affected_package: bcrypt
  vulnerable_versions:
  - "*"
  severity: low
  package_manager: npm
  cwe:
  - CWE-208
  disclosed_date: 2019-04-24
  created_date: 2019-04-25
  last_modified_date: 2019-04-25
  credit:
  - Andrew Carter
  references:
  - https://gist.github.com/AndrewCarterUK/7b730e2ce16c7546b33120e1688c901a
  - https://github.com/kelektiv/node.bcrypt.js/issues/720
  source_url: https://snyk.io/vuln/SNYK-JS-BCRYPT-174521
- id: snykio:npm:bcrypt:572911
  title: Insecure Encryption
  description: |
    [bcrypt][1] is an A library to help you hash passwords.

    Affected versions of this package are vulnerable to Insecure Encryption.
    Data is truncated wrong when its length is greater than 255 bytes.



    [1]: https://www.npmjs.com/package/bcrypt
  affected_package: bcrypt
  vulnerable_versions:
  - "<5.0.0"
  severity: medium
  package_manager: npm
  cve:
  - CVE-2020-7689
  cwe:
  - CWE-326
  disclosed_date: 2020-06-21
  created_date: 2020-07-01
  last_modified_date: 2020-07-01
  credit:
  - pool683
  references:
  - https://github.com/kelektiv/node.bcrypt.js/issues/776
  - https://github.com/kelektiv/node.bcrypt.js/pull/806
  - https://github.com/kelektiv/node.bcrypt.js/pull/807
  source_url: https://snyk.io/vuln/SNYK-JS-BCRYPT-572911
- id: snykio:npm:bcrypt:575033
  title: Cryptographic Issues
  description: |
    [bcrypt][1] is an A library to help you hash passwords.

    Affected versions of this package are vulnerable to Cryptographic
    Issues. When hashing a password containing an ASCII NUL character, that
    character acts as the string terminator. Any following characters are
    ignored.



    [1]: https://www.npmjs.com/package/bcrypt
  affected_package: bcrypt
  vulnerable_versions:
  - "<5.0.0"
  severity: medium
  package_manager: npm
  cwe:
  - CWE-310
  disclosed_date: 2020-01-13
  created_date: 2020-07-01
  last_modified_date: 2020-07-01
  credit:
  - Felix
  references:
  - https://github.com/kelektiv/node.bcrypt.js/issues/774
  - https://github.com/kelektiv/node.bcrypt.js/pull/807
  source_url: https://snyk.io/vuln/SNYK-JS-BCRYPT-575033
