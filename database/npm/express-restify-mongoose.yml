---
- id: npmjs:npm:express-restify-mongoose:92
  title: Private Data Disclosure
  description: "Affected versions of `express-restify-mongoose` are susceptible to
    an information leakage vulnerability which may allow an attacker to access fields
    on a model even if those fields are marked as private.\n\n\n## Proof of Concept\n\nIf
    you have a user model that you want to protect, such as the following User model:\n```\nconst
    User = mongoose.model('User', new mongoose.Schema({\n    name: String,\n    password:
    String,\n}));\n```\n\nYou would normally do something such as:\n```\nrestify.serve(router,
    User, {\n    private: ['password'], // Set the password part of User as private,
    so outside people can't read it\n})\n```\n\nThis would hide the password field
    from people that send your application a `GET /User` and `GET /User/some-user-id`
    request. \n\nA malicious user can go to your application and send a request for
    `GET /User?distinct=password` and get all the passwords for all the users in the
    database, despite the field being set to private. This could be used for other
    private data, if the malicious user knew what was set as private for specific
    routes."
  affected_package: express-restify-mongoose
  vulnerable_versions:
  - "<= 2.4.2"
  - ">= 3.0.0 <=3.0.1"
  severity: high
  package_manager: npm
  cve:
  - CVE-2016-10533
  cwe: CWE-200
  disclosed_date: 1970-01-01
  created_date: 1970-01-01
  last_modified_date: 1970-01-01
  credit: Stefan Mirea
- id: ossindex:npm:express-restify-mongoose:8405000460
  title: Private Data Disclosure
  description: "> express-restify-mongoose is a module to easily create a flexible
    REST interface for mongoose models.\n> \n> -- [nodesecurity.io](https://nodesecurity.io/advisories/92)"
  affected_package: express-restify-mongoose
  vulnerable_versions:
  - "<=2.4.2 | >=3.0.0 <=3.0.1"
  package_manager: npm
  disclosed_date: 2017-07-29
  created_date: 2017-07-29
  last_modified_date: 2017-07-29
  credit:
  - OSSIndex
  references:
  - https://github.com/florianholzapfel/express-restify-mongoose/issues/252
  - https://nodesecurity.io/advisories/92
  source_url: https://ossindex.net/resource/package/7013568361/vulnerabilities
- id: snykio:npm:express-restify-mongoose:20160419
  title: Private Data Disclosure
  description: |+
    `express-restify-mongoose` is a module to easily create a flexible REST
    interface for mongoose models.

    It supports marking certain fields as private, to keep from exposing
    them to users, but fails to remove those fields from certain output
    scenarios, resulting in potential private data exposure.

    For instance, if you have the following User model:

        const User = mongoose.model('User', new mongoose.Schema({
            name: String,
            password: String,
        }));

    To keep from exposing the password, you\'ll likely to want to call it
    out as a private field like so:

        restify.serve(router, User, {
            private: ['password'],
        })

    This will indeed result in the password field not showing when you
    request an item, for instance via `GET /User` or `GET /User/some-id`.

    However, when querying on that field, using `GET
    /User?distinct=password`, ALL passwords for ALL the users in the DB
    would be shown.

  affected_package: express-restify-mongoose
  vulnerable_versions:
  - "< 2.5.0"
  - ">= 3.0.0 <3.1.0"
  severity: high
  package_manager: npm
  cve:
  - CVE-2016-10533
  cwe:
  - CWE-200
  disclosed_date: 2016-04-19
  created_date: 2016-06-22
  last_modified_date: 2016-06-22
  credit:
  - Stefan Mirea
  references:
  - https://github.com/florianholzapfel/express-restify-mongoose/issues/252
  - https://github.com/florianholzapfel/express-restify-mongoose/pull/253
  source_url: https://snyk.io/vuln/npm:express-restify-mongoose:20160419
