---
- id: npmjs:npm:loopback-connector-mongodb:696
  title: NoSQL Injection
  description: |+
    Versions of `loopback-connector-mongodb` before 3.6.0 are vulnerable to NoSQL injection.

    MongoDB Connector for LoopBack fails to properly sanitize a filter passed to query the database by allowing the dangerous `$where` property to be passed to the MongoDB Driver. The Driver allows the special `$where` property in a filter to execute JavaScript (client can pass in a malicious script) on the database Driver. This is an [intended feature of MongoDB](https://docs.mongodb.com/manual/core/server-side-javascript/) unless disabled ([instructions here](https://docs.mongodb.com/manual/core/server-side-javascript/#disable-server-side-js)).

    A proof of concept malicious query:

    ```
    GET /POST filter={"where": {"$where": "function(){sleep(5000); return this.title.contains('Hello');}"}}
    ```

    The above makes the database sleep for 5 seconds and then returns all “Posts” with the title containing the word `Hello`.

  affected_package: loopback-connector-mongodb
  vulnerable_versions:
  - "<=3.5.0"
  severity: high
  package_manager: npm
  cwe: CWE-943
  disclosed_date: 1970-01-01
  created_date: 1970-01-01
  last_modified_date: 1970-01-01
  credit: NelsonBrandao
  references: https://npmjs.com/advisories/696
  source_url: https://npmjs.com/advisories/696
- id: npmjs:npm:loopback-connector-mongodb:767
  title: NoSQL Injection
  description: Versions of `loopback-connector-mongodb` prior to 3.6.0 are vulnerable
    to NoSQL Injection. Filters passed to the database query are not properly sanitized
    which leads to execution of code on the database driver and data leak.
  affected_package: loopback-connector-mongodb
  vulnerable_versions:
  - "<=3.5.0"
  severity: high
  package_manager: npm
  cwe: CWE-943
  disclosed_date: 1970-01-01
  created_date: 1970-01-01
  last_modified_date: 1970-01-01
  credit: Nelson Brandao
  references: https://npmjs.com/advisories/767
  source_url: https://npmjs.com/advisories/767
- id: snykio:npm:loopback-connector-mongodb:73555
  title: SQL Injection
  description: |
    [loopback-connector-mongodb][1] is the official MongoDB connector for
    the LoopBack framework.

    Affected versions of this package are vulnerable to SQL Injection.
    Improper sanitising of filters passed to the database query, may cause
    code execution on the database driver and may also lead to data leakage.



    [1]: https://www.npmjs.com/package/loopback-connector-mongodb
  affected_package: loopback-connector-mongodb
  vulnerable_versions:
  - "<3.6.0"
  severity: high
  package_manager: npm
  cwe:
  - CWE-89
  disclosed_date: 2019-01-15
  created_date: 2019-01-20
  last_modified_date: 2019-01-20
  credit:
  - Nelson Brandão
  references:
  - https://github.com/strongloop/loopback-connector-mongodb/issues/403
  - https://loopback.io/doc/en/lb3/Security-advisory-08-15-2018.html
  source_url: https://snyk.io/vuln/SNYK-JS-LOOPBACKCONNECTORMONGODB-73555
