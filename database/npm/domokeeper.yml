---
- id: npmjs:npm:domokeeper:1075
  title: Local File Inclusion
  description: All versions of `domokeeper` are vulnerable to Local File Inclusion.
    The `/plugin/` route passes a GET parameter unsanitized to a `require()` call.
    It then returns the output of `require()` in the server response. This may allow
    attackers to load unintended code in the application. It also allows attackers
    to exfiltrate information in `.json` files.
  affected_package: domokeeper
  vulnerable_versions:
  - ">=0.0.0"
  severity: medium
  package_manager: npm
  cwe: CWE-20
  disclosed_date: 1970-01-01
  created_date: 1970-01-01
  last_modified_date: 1970-01-01
  credit: Vasiliy Ermilov
- id: snykio:npm:domokeeper:451513
  title: Arbitrary Code Execution
  description: |
    [domokeeper][1] is a pluggable domotic control server for Raspberry Pi
    2/3.

    Affected versions of this package are vulnerable to Arbitrary Code
    Execution. The path to required module is passed in an HTTP request
    without any sanitisation, thus making it possible to load code that was
    not intended to run on the server. In addition, the fact that output of
    the module is passed to server response directly may cause information
    leakage. For example it is possible to read `package.json` file or any
    other json file.



    [1]: https://www.npmjs.com/package/domokeeper
  affected_package: domokeeper
  vulnerable_versions:
  - "*"
  severity: medium
  package_manager: npm
  cwe:
  - CWE-200
  - CWE-23
  - CWE-94
  disclosed_date: 2019-07-04
  created_date: 2019-07-04
  last_modified_date: 2019-07-04
  credit:
  - Vasiliy Ermilov (inkz)
  references:
  - https://github.com/jperelli/domokeeper/issues/2
  - https://hackerone.com/reports/538938
  source_url: https://snyk.io/vuln/SNYK-JS-DOMOKEEPER-451513
- id: snykio:npm:domokeeper:455475
  title: Arbitrary Code Execution
  description: |
    [domokeeper][1] is a pluggable domotic control server for Raspberry Pi
    2/3.

    Affected versions of this package are vulnerable to Arbitrary Code
    Execution. `/plugin/` route passes an unsanitized GET request to a
    `require()` call. It then returns the output of `require()` in the
    response.



    [1]: https://www.npmjs.com/package/domokeeper
  affected_package: domokeeper
  vulnerable_versions:
  - ">=0.0.0"
  severity: high
  package_manager: npm
  cwe:
  - CWE-94
  disclosed_date: 2019-07-17
  created_date: 2019-07-29
  last_modified_date: 2019-07-29
  credit:
  - Vasiliy Ermilov
  references:
  - https://www.npmjs.com/advisories/1075
  source_url: https://snyk.io/vuln/SNYK-JS-DOMOKEEPER-455475
