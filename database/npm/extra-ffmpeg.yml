---
- id: snykio:npm:extra-ffmpeg:607911
  title: Command Injection
  description: |
    [extra-ffmpeg][1] is a Decode, encode, transcode, mux, demux, stream,
    filter, and play media through machine (via \"ffmpeg\").

    Affected versions of this package are vulnerable to Command Injection.
    It is possible to inject arbitrary commands due to insecure command
    formatting. User input inserted as part of the `os` parameter is passed
    to the `child_process.exec` function without any check.

    ### PoC   {#poc}

        const ffmpeg = require('extra-ffmpeg');
        ffmpeg.sync([{y: true}, {i: '`touch HACKED`'}, {acodec: 'copy', o: 'aud.mp3'}]);



    [1]: https://www.npmjs.com/package/extra-ffmpeg
  affected_package: extra-ffmpeg
  vulnerable_versions:
  - "*"
  severity: high
  package_manager: npm
  cwe:
  - CWE-78
  disclosed_date: 2020-08-20
  created_date: 2020-08-20
  last_modified_date: 2020-08-20
  credit:
  - d3lla
  references:
  - https://github.com/nodef/extra-ffmpeg/commit/e39f999494209c042b39cd74edc44758ff29172b
  - https://hackerone.com/reports/863944
  source_url: https://snyk.io/vuln/SNYK-JS-EXTRAFFMPEG-607911
