---
- id: ossindex:npm:clamscan:8405001048
  title: Code execution
  description: "> If you are using a version prior to 0.8.2, please upgrade! There
    was a security vulnerability in previous versions that allows a malicious user
    to execute code on your server. Specific details on how the attack could be implemented
    will not be disclosed here. Please update to 0.8.2 or greater ASAP. No breaking
    changes are included, only the security patch.\n> \n> -- [github.com](https://github.com/kylefarris/clamscan/blob/e2a7cbcd222aa8bbd61477fc3beabbe9ad3d8a71/README.md)"
  affected_package: clamscan
  vulnerable_versions:
  - "<0.8.2"
  package_manager: npm
  disclosed_date: 2017-07-30
  created_date: 2017-07-30
  last_modified_date: 2017-07-30
  credit:
  - OSSIndex
  references:
  - https://github.com/kylefarris/clamscan/blob/e2a7cbcd222aa8bbd61477fc3beabbe9ad3d8a71/README.md
  - https://github.com/kylefarris/clamscan/commit/f884b6892fd124d7efb2d76d2ffd56c04fda8209
  source_url: https://ossindex.net/resource/package/7012187470/vulnerabilities
- id: snykio:npm:clamscan:20150821
  title: Arbitrary Command Execution
  description: |
    [`clamscan`][1] is Use Node JS to scan files on your server with
    ClamAV\'s clamscan binary or clamdscan daemon. Affected versions of the
    package are vulnerable to Arbitrary Command Execution. No other
    information was given.



    [1]: https://www.npmjs.com/package/clamscan
  affected_package: clamscan
  vulnerable_versions:
  - "<0.8.2"
  severity: high
  package_manager: npm
  cwe:
  - CWE-94
  disclosed_date: 2015-08-20
  created_date: 2017-01-18
  last_modified_date: 2017-01-18
  credit:
  - Unknown
  references:
  - https://github.com/kylefarris/clamscan/commit/e2a7cbcd222aa8bbd61477fc3beabbe9ad3d8a71
  source_url: https://snyk.io/vuln/npm:clamscan:20150821
- id: snykio:npm:clamscan:564113
  title: Command Injection
  description: |
    [clamscan][1] is an Use Node JS to scan files on your server with
    ClamAV\'s clamscan binary or clamdscan daemon. This is especially useful
    for scanning uploaded files provided by un-trusted sources.

    Affected versions of this package are vulnerable to Command Injection.
    It is possible to inject arbitrary commands as part of the
    `_is_clamav_binary` function located within `Index.js`.

    It should be noted that this vulnerability requires a pre-requisite that
    a folder should be created with the same command that will be chained to
    execute. This lowers the risk of this issue.

    ### PoC by Snyk   {#poc-by-snyk}

        var Root = require("clamscan");
        var fs = require("fs");
        var attack_code = "echo vulnerable > create.txt";
        var root = new Root();
        fs.mkdir(attack_code + "&", function(){});
        root.init({"clamscan": {'path': attack_code + "&"}});



    [1]: https://github.com/kylefarris/clamscan
  affected_package: clamscan
  vulnerable_versions:
  - "<1.3.0"
  severity: low
  package_manager: npm
  cve:
  - CVE-2020-7613
  cwe:
  - CWE-79
  disclosed_date: 2020-04-01
  created_date: 2020-04-01
  last_modified_date: 2020-04-01
  credit:
  - JHU System Security Lab
  references:
  - https://github.com/kylefarris/clamscan/blob/master/index.js#L34
  - https://github.com/kylefarris/clamscan/commit/5f557c970817fe8c578ec3f7ad3bcbcef4cf5538
  source_url: https://snyk.io/vuln/SNYK-JS-CLAMSCAN-564113
