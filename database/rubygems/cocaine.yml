---
- id: rubyadvisory:rubygems:cocaine:CVE-2013-4457
  title: Cocaine Gem for Ruby contains a flaw
  description: Cocaine Gem for Ruby contains a flaw that is due to the method of variable
    interpolation used by the program. With a specially crafted object, a context-dependent
    attacker can execute arbitrary commands.
  affected_package: cocaine
  unaffected_versions:
  - "< 0.4.0"
  patched_versions:
  - ">= 0.5.3"
  severity: high
  package_manager: rubygems
  cve: CVE-2013-4457
  osvdb: 98835
  cvss_v2_score: 6.8
  disclosed_date: 2013-10-22
  created_date: 2013-10-22
  last_modified_date: 2013-10-22
  credit:
  - Rubysec
  references:
  - https://github.com/rubysec/ruby-advisory-db
  source_url: http://www.osvdb.org/show/osvdb/98835
- id: snykio:rubygems:cocaine:CVE-2013-4457
  title: Arbitrary Command Injection
  description: |+
    [`cocaine`][1] is a library for doing command lines.

    Affected versions of this gem are vulnerable to an attacker injecting
    hostile commands into a command line via a crafted hash object which is
    not properly escaped. This is due to the method of variable
    interpolation used by the gem, allowing an attacker to execute arbitrary
    commands via a crafted `has` object, related to recursive variable
    interpolation.



    [1]: https://rubygems.org/gems/cocaine
    \nThe impact is lessened on Ruby version 1.8.\* because hashes are not
    ordered by default, so an attacker must rely on luck for the attack to
    work.

    An attack of this sort cannot take place if there is only one value
    being interpolated into the command line.

  affected_package: cocaine
  vulnerable_versions:
  - "< 0.5.3  >= 0.4.0"
  severity: medium
  package_manager: rubygems
  cve:
  - CVE-2013-4457
  cwe:
  - CWE-77
  disclosed_date: 2013-10-21
  created_date: 2013-10-21
  last_modified_date: 2013-10-21
  credit:
  - Holger Just
  references:
  - http://rubysec.com/advisories/CVE-2013-4457/
  - http://www.openwall.com/lists/oss-security/2013/10/22/10
  - https://github.com/thoughtbot/cocaine/blob/master/NEWS.md
  source_url: https://snyk.io/vuln/SNYK-RUBY-COCAINE-20113
