---
- id: rubyadvisory:rubygems:mini_magick:CVE-2019-13574
  title: Remote command execution via filename
  description: |
    A remote shell execution vulnerability when using MiniMagick::Image.open with URL coming from unsanitized user input.
    e.g. `MiniMagick::Image.open("| touch.txt")`
  affected_package: mini_magick
  patched_versions:
  - ">= 4.9.4"
  severity: high
  package_manager: rubygems
  cve:
  - CVE-2019-13574
  cvss_v3_score: 7.5
  disclosed_date: 2019-07-12
  created_date: 2019-07-12
  last_modified_date: 2019-07-12
  credit:
  - Rubysec
  references:
  - https://github.com/minimagick/minimagick/commit/4cd5081e58810d3394d27a67219e8e4e0445d851
  - https://github.com/rubysec/ruby-advisory-db
  source_url: https://benjamin-bouchet.com/blog/vulnerabilite-dans-la-gem-mini_magick-version-4-9-4/
- id: rubyadvisory:rubygems:mini_magick:OSVDB-91231
  title: MiniMagick Gem for Ruby URI Handling Arbitrary Command Injection
  description: |
    MiniMagick Gem for Ruby contains a flaw that is triggered during the handling
    of specially crafted input from an untrusted source passed via a URL that
    contains a ';' character. This may allow a context-dependent attacker to
    potentially execute arbitrary commands.
  affected_package: mini_magick
  patched_versions:
  - ">= 3.6.0"
  severity: high
  package_manager: rubygems
  cve:
  - CVE-2013-2616
  osvdb: 91231
  cvss_v2_score: 9.3
  disclosed_date: 2013-03-12
  created_date: 2013-03-12
  last_modified_date: 2013-03-12
  credit:
  - Rubysec
  references:
  - https://github.com/rubysec/ruby-advisory-db
  source_url: http://osvdb.org/show/osvdb/91231
- id: snykio:rubygems:mini_magick:20084
  title: Arbitrary Command Injection
  description: |
    [`mini_magick`][1] is a Ruby wrapper for ImageMagick or GraphicsMagick
    command line.

    Affected versions contain a flaw in `lib/mini_magick.rb` that allows
    remote attackers to execute commands via a URL that contains a `;`
    character.



    [1]: https://rubygems.org/gems/mini_magick
  affected_package: mini_magick
  vulnerable_versions:
  - "<3.6.0"
  severity: high
  package_manager: rubygems
  cve:
  - CVE-2013-2616
  cwe:
  - CWE-77
  disclosed_date: 2013-03-11
  created_date: 2013-03-11
  last_modified_date: 2013-03-11
  credit:
  - Unknown
  references:
  - http://rubysec.com/advisories/CVE-2013-2616/
  - http://seclists.org/fulldisclosure/2013/Mar/123
  source_url: https://snyk.io/vuln/SNYK-RUBY-MINIMAGICK-20084
- id: snykio:rubygems:mini_magick:451567
  title: Remote Code Execution
  description: |
    [mini\_magick][1] is a ruby wrapper for ImageMagick or GraphicsMagick
    command line.

    Affected versions of this package are vulnerable to Remote Code
    Execution. A fetched remote image filename can cause remote command
    execution due to `Image.open` input being directly passed to
    `Kernel#open`, which accepts a `|` character followed by a command.



    [1]: https://github.com/minimagick/minimagick
  affected_package: mini_magick
  vulnerable_versions:
  - "<4.9.4"
  severity: high
  package_manager: rubygems
  cve:
  - CVE-2019-13574
  cwe:
  - CWE-94
  disclosed_date: 2019-07-12
  created_date: 2019-07-12
  last_modified_date: 2019-07-12
  credit:
  - Janko Marohnic
  references:
  - https://github.com/minimagick/minimagick/commit/4cd5081e58810d3394d27a67219e8e4e0445d851
  - https://github.com/minimagick/minimagick/releases/tag/v4.9.4
  source_url: https://snyk.io/vuln/SNYK-RUBY-MINIMAGICK-451567
