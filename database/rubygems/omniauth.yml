---
- id: rubyadvisory:rubygems:omniauth:CVE-2015-9284
  title: CSRF vulnerability in OmniAuth's request phase
  description: |
    The request phase of the OmniAuth Ruby gem is vulnerable to Cross-Site
    Request Forgery (CSRF) when used as part of the Ruby on Rails framework, allowing
    accounts to be connected without user intent, user interaction, or feedback to
    the user. This permits a secondary account to be able to sign into the web
    application as the primary account.

    In order to mitigate this vulnerability, Rails users should consider using the
    `omniauth-rails_csrf_protection` gem.

    More info is available here: https://github.com/omniauth/omniauth/pull/809#issuecomment-502079405
  affected_package: omniauth
  vulnerable_versions:
  - "*"
  severity: high
  package_manager: rubygems
  cve:
  - CVE-2015-9284
  cvss_v2_score: 6.8
  cvss_v3_score: 8.8
  disclosed_date: 2015-05-25
  created_date: 2015-05-25
  last_modified_date: 2015-05-25
  credit:
  - Rubysec
  references:
  - https://github.com/cookpad/omniauth-rails_csrf_protection
  - https://github.com/rubysec/ruby-advisory-db
  source_url: https://github.com/omniauth/omniauth/pull/809
- id: rubyadvisory:rubygems:omniauth:CVE-2017-18076
  title: omniauth leaks authenticity token in callback params
  description: 'In strategy.rb in OmniAuth before 1.3.2, the authenticity_token value
    is improperly protected because POST (in addition to GET) parameters are stored
    in the session and become available in the environment of the callback phase.

'
  affected_package: omniauth
  patched_versions:
  - ">= 1.3.2"
  severity: high
  package_manager: rubygems
  cve:
  - CVE-2017-18076
  cvss_v2_score: 6.8
  disclosed_date: 2017-01-11
  created_date: 2017-01-11
  last_modified_date: 2017-01-11
  credit:
  - Rubysec
  references:
  - https://github.com/rubysec/ruby-advisory-db
  - https://nvd.nist.gov/vuln/detail/CVE-2017-18076
  source_url: https://github.com/omniauth/omniauth/pull/867
- id: snykio:rubygems:omniauth:174820
  title: Cross-site Request Forgery (CSRF)
  description: "[omniauth][1] is a generalized Rack framework for multiple-provider\nauthentication.\n\nAffected
    versions of this package are vulnerable to Cross-site Request\nForgery (CSRF).
    An attacker may be allowed to be connected to the user\nwithout the user\\'s intent,
    interaction, or feedback. This permits a\nsecondary account to be able to sign
    into the web application as the\nprimary account.\n\n**Note:**\n\n* The package
    is only vulnerable when used as part of the Ruby on Rails\n  framework.\n* It
    is possible to use the `omniauth-rails_csrf_protection` gem to\n  mitigate this
    attack\n  ## Remediation   {#remediation}\n  \n  There is no fixed version for
    `omniauth`.\n  ## References   {#references}\n\n* [GitHub PR][2]\n* [GitHub PR][3]\n*
    [omniauth-rails\\_csrf\\_protection gem][4]\n\n\n\n[1]: https://rubygems.org/gems/omniauth\n[2]:
    https://github.com/omniauth/omniauth/pull/809\n[3]: https://github.com/omniauth/omniauth-rails/pull/2\n[4]:
    https://github.com/cookpad/omniauth-rails_csrf_protection\n"
  affected_package: omniauth
  vulnerable_versions:
  - ">=0.0.0"
  severity: high
  package_manager: rubygems
  cve:
  - CVE-2015-9284
  cwe:
  - CWE-352
  disclosed_date: 2015-04-24
  created_date: 2019-05-30
  last_modified_date: 2019-05-30
  credit:
  - Mohamed Abdelbaset Elnoby
  source_url: https://snyk.io/vuln/SNYK-RUBY-OMNIAUTH-174820
- id: snykio:rubygems:omniauth:22012
  title: Information Exposure
  description: |
    [Omniauth][1] is a library that standardizes multi-provider
    authentication for web applications.

    Affected versions of this package are vulnerable to Information
    Exposure. the authenticity\_token value is improperly protected because
    POST (in addition to GET) parameters are stored in the session and
    become available in the environment of the callback phase.



    [1]: https://github.com/omniauth/omniauth
  affected_package: omniauth
  vulnerable_versions:
  - "<1.3.2"
  severity: high
  package_manager: rubygems
  cve:
  - CVE-2017-18076
  cwe:
  - CWE-200
  disclosed_date: 2017-01-17
  created_date: 2018-02-06
  last_modified_date: 2018-02-06
  credit:
  - Unknown
  references:
  - https://github.com/omniauth/omniauth/pull/867
  - https://github.com/omniauth/omniauth/pull/867/commits/71866c5264122e196847a3980c43051446a03e9b
  - https://nvd.nist.gov/vuln/detail/CVE-2017-18076
  source_url: https://snyk.io/vuln/SNYK-RUBY-OMNIAUTH-22012
