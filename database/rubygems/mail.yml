---
- id: rubyadvisory:rubygems:mail:CVE-2015-9097
  title: SMTP command injection
  description: |
    Because Mail does not disallow CRLF in email addresses, an attacker can
    inject SMTP commands in specially crafted email addresses passed to
    RCPT TO and MAIL FROM.

    Not affected by this vulnerability:
      * Ruby 2.4.0+ with a fix for CVE-2015-9096.
      * Applications that do not use SMTP delivery.
      * Applications that validate email addresses to not include CRLF.

    The injection attack is described in Terada, Takeshi. "SMTP Injection via
    Recipient Email Addresses." 2015. The attacks described in the paper
    (Terada, p. 4) can be applied to the library without any modification.
  affected_package: mail
  patched_versions:
  - ">= 2.5.5"
  package_manager: rubygems
  cve:
  - CVE-2015-9097
  osvdb: 131677
  disclosed_date: 2015-12-09
  created_date: 2015-12-09
  last_modified_date: 2015-12-09
  credit:
  - Rubysec
  references:
  - http://www.mbsd.jp/Whitepaper/smtpi.pdf
  - https://github.com/mikel/mail/pull/1097
  - https://github.com/rubysec/ruby-advisory-db
  source_url: https://hackerone.com/reports/137631
- id: rubyadvisory:rubygems:mail:OSVDB-131677
  title: SMTP command injection
  description: |
    Because Mail does not disallow CRLF in email addresses, an attacker can
    inject SMTP commands in specially crafted email addresses passed to
    RCPT TO and MAIL FROM.

    Not affected by this vulnerability:
      * Ruby 2.4.0+ with a fix for CVE-2015-9096.
      * Applications that do not use SMTP delivery.
      * Applications that validate email addresses to not include CRLF.

    The injection attack is described in Terada, Takeshi. "SMTP Injection via
    Recipient Email Addresses." 2015. The attacks described in the paper
    (Terada, p. 4) can be applied to the library without any modification.
  affected_package: mail
  patched_versions:
  - ">= 2.5.5"
  package_manager: rubygems
  cve:
  - CVE-2015-9097
  osvdb: 131677
  disclosed_date: 2015-12-09
  created_date: 2015-12-09
  last_modified_date: 2015-12-09
  credit:
  - Rubysec
  references:
  - http://www.mbsd.jp/Whitepaper/smtpi.pdf
  - https://github.com/mikel/mail/pull/1097
  - https://github.com/rubysec/ruby-advisory-db
  source_url: https://hackerone.com/reports/137631
- id: rubyadvisory:rubygems:mail:OSVDB-70667
  title: "Mail Gem for Ruby lib/mail/network/delivery_methods/sendmail.rb Email From:
    Address Arbitrary Shell Command Injection \n"
  description: |
    Mail Gem for Ruby contains a flaw related to the failure to properly sanitise
    input passed from an email from address in the 'deliver()' function in
    'lib/mail/network/delivery_methods/sendmail.rb' before being used as a
    command line argument. This may allow a remote attacker to inject arbitrary
    shell commands.
  affected_package: mail
  patched_versions:
  - ">= 2.2.15"
  severity: high
  package_manager: rubygems
  cve:
  - CVE-2011-0739
  osvdb: 70667
  cvss_v2_score: 6.8
  disclosed_date: 2011-01-25
  created_date: 2011-01-25
  last_modified_date: 2011-01-25
  credit:
  - Rubysec
  references:
  - https://github.com/rubysec/ruby-advisory-db
  source_url: http://www.osvdb.org/show/osvdb/70667
- id: rubyadvisory:rubygems:mail:OSVDB-81631
  title: Mail Gem for Ruby File Delivery Method to Parameter Traversal Arbitrary File
    Manipulation
  description: 'Mail Gem for Ruby contains a flaw that allows a remote attacker to
    traverse outside of a restricted path. The issue is due to the program not properly
    sanitizing user input, specifically directory traversal style attacks (e.g., ../../)
    supplied via the ''to'' parameter within the delivery method. This directory traversal
    attack would allow the attacker to modify arbitrary files.

'
  affected_package: mail
  patched_versions:
  - ">= 2.4.4"
  severity: medium
  package_manager: rubygems
  cve:
  - CVE-2012-2139
  osvdb: 81631
  cvss_v2_score: 5.0
  disclosed_date: 2012-03-14
  created_date: 2012-03-14
  last_modified_date: 2012-03-14
  credit:
  - Rubysec
  references:
  - https://github.com/rubysec/ruby-advisory-db
  source_url: http://www.osvdb.org/show/osvdb/81631
- id: rubyadvisory:rubygems:mail:OSVDB-81632
  title: Mail Gem for Ruby Multiple Delivery Method Remote Shell Command Execution
  description: |
    Mail Gem for Ruby contains a flaw that occurs within the sendmail and exim
    delivery methods, which may allow an attacker to execute arbitrary shell
    commands..
  affected_package: mail
  patched_versions:
  - ">= 2.4.4"
  severity: high
  package_manager: rubygems
  cve:
  - CVE-2012-2140
  osvdb: 81632
  cvss_v2_score: 7.5
  disclosed_date: 2012-03-14
  created_date: 2012-03-14
  last_modified_date: 2012-03-14
  credit:
  - Rubysec
  references:
  - https://github.com/rubysec/ruby-advisory-db
  source_url: http://www.osvdb.org/show/osvdb/81632
- id: snykio:rubygems:mail:20013
  title: Arbitrary Shell Command Injection
  description: |
    [`mail`][1] is a Ruby Mail handler gem.

    Affected versions of this gem do not properly sanitise input passed from
    an email from address in the `deliver()` function in
    `lib/mail/network/delivery_methods/sendmail.rb` before being used as a
    command line argument. This may allow a remote attacker to inject
    arbitrary shell commands.



    [1]: https://rubygems.org/gems/mail
  affected_package: mail
  vulnerable_versions:
  - "< 2.2.15"
  severity: medium
  package_manager: rubygems
  cve:
  - CVE-2011-0739
  cwe:
  - CWE-77
  disclosed_date: 2011-01-24
  created_date: 2011-01-24
  last_modified_date: 2011-01-24
  credit:
  - Andy Lindeman
  - Steven Lorek
  references:
  - http://rubysec.com/advisories/CVE-2011-0739/
  - https://groups.google.com/forum/#!topic/mail-ruby/6Tu9BXBkeN0
  - https://raw.githubusercontent.com/mikel/mail/master/patches/20110126_sendmail.patch
  source_url: https://snyk.io/vuln/SNYK-RUBY-MAIL-20013
- id: snykio:rubygems:mail:20026
  title: Directory Traversal
  description: |
    [`mail`][1] is a Ruby Mail handler gem.

    Affected versions of this gem allow a remote attacker to traverse
    outside of a restricted path. This is due to the program not properly
    sanitizing user input, specifically directory traversal style attacks
    (e.g. `../../`) supplied via the `to` parameter within the delivery
    method.

    This directory traversal attack would allow the attacker to modify
    arbitrary files.



    [1]: https://rubygems.org/gems/mail
    \nA Directory Traversal attack (also known as path traversal) aims to
    access files and directories that are stored outside the intended
    folder. By manipulating files with \"dot-dot-slash (../)\" sequences and
    its variations, or by using absolute file paths, it may be possible to
    access arbitrary files and directories stored on file system, including
    application source code, configuration, and other critical system files.

    Directory Traversal vulnerabilities can be generally divided into two
    types:

    * **Information Disclosure**\: Allows the attacker to gain information
      about the folder structure or read the contents of sensitive files on
      the system.

    `st` is a module for serving static files on web pages, and contains a
    [vulnerability of this type][1]. In our example, we will serve files
    from the `public` route.

    If an attacker requests the following URL from our server, it will in
    turn leak the sensitive private key of the root user.

        curl http://localhost:8080/public/%2e%2e/%2e%2e/%2e%2e/%2e%2e/%2e%2e/root/.ssh/id_rsa

    **Note** `%2e` is the URL encoded version of `.` (dot).

    * **Writing arbitrary files**\: Allows the attacker to create or replace
      existing files. This type of vulnerability is also known as
      `Zip-Slip`.

    One way to achieve this is by using a malicious `zip` archive that holds
    path traversal filenames. When each filename in the zip archive gets
    concatenated to the target extraction folder, without validation, the
    final path ends up outside of the target folder. If an executable or a
    configuration file is overwritten with a file containing malicious code,
    the problem can turn into an arbitrary code execution issue quite
    easily.

    The following is an example of a `zip` archive with one benign file and
    one malicious file. Extracting the malicious file will result in
    traversing out of the target folder, ending up in `/root/.ssh/`
    overwriting the `authorized_keys` file:

        2018-04-15 22:04:29 .....           19           19  good.txt
        2018-04-15 22:04:42 .....           20           20  ../../../../../../root/.ssh/authorized_keys



    [1]: https://snyk.io/vuln/npm:st:20140206
  affected_package: mail
  vulnerable_versions:
  - "< 2.4.4"
  severity: medium
  package_manager: rubygems
  cve:
  - CVE-2012-2139
  cwe:
  - CWE-22
  disclosed_date: 2012-03-13
  created_date: 2012-03-13
  last_modified_date: 2012-03-13
  credit:
  - Unknown
  references:
  - http://rubysec.com/advisories/CVE-2012-2139/
  - http://www.openwall.com/lists/oss-security/2012/04/25/8
  - https://github.com/mikel/mail/commit/29aca25218e4c82991400eb9b0c933626aefc98f
  source_url: https://snyk.io/vuln/SNYK-RUBY-MAIL-20026
- id: snykio:rubygems:mail:20027
  title: Remote Shell Command Execution
  description: |
    [`mail`][1] is a Ruby Mail handler gem.

    Affected versions of this gem contains a flaw within the `sendmail` and
    `exim` delivery methods, which may allow an attacker to execute
    arbitrary shell commands.



    [1]: https://rubygems.org/gems/mail
  affected_package: mail
  vulnerable_versions:
  - "< 2.4.4"
  severity: high
  package_manager: rubygems
  cve:
  - CVE-2012-2140
  cwe:
  - CWE-77
  disclosed_date: 2012-03-13
  created_date: 2012-03-13
  last_modified_date: 2012-03-13
  credit:
  - Unknown
  references:
  - http://rubysec.com/advisories/CVE-2012-2140/
  - http://www.openwall.com/lists/oss-security/2012/04/25/8
  - http://www.osvdb.org/show/osvdb/81632
  source_url: https://snyk.io/vuln/SNYK-RUBY-MAIL-20027
