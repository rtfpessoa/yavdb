---
- id: snykio:maven:org.springframework.data:spring-data-rest-webmvc:31577
  title: Arbitrary Code Execution
  description: |
    [org.springframework.data:spring-data-rest-webmvc][1] is a maven plugin
    for Spring Data REST - WebMVC.

    Affected versions of this package are vulnerable to Arbitrary Code
    Execution. It is caused due to the way Spring uses it\'s own expression
    language in the Data REST component.

    The Spring Expression Language (SpEL) is an expression language (similar
    to OGNL, MVEL, and JBoss EL) which serves as the foundation for
    expression evaluation within the Spring portfolio. It supports querying
    and manipulating an object graph at runtime.

    User input was not validated upon sending a PATCH request with a `path`
    parameter to `spring-data-rest` servers. An attacker may sumit a
    specially crafted PATCH request with a path containing SpEL syntax, and
    the Spring REST server, would in turn run these expressions.

    An example for an invalid PATCH request:

        [
            {"op":"replace", "path":"<Malicious SpEL code>", "value": "bar" }
        ]
    {: .language-json}



    [1]: https://github.com/SpringSource/spring-data-rest
  affected_package: org.springframework.data:spring-data-rest-webmvc
  vulnerable_versions:
  - "< 2.6.7.RELEASE"
  severity: high
  package_manager: maven
  cve:
  - CVE-2017-8046
  cwe:
  - CWE-94
  disclosed_date: 2017-09-07
  created_date: 2018-04-16
  last_modified_date: 2018-04-16
  credit:
  - Man Yue Mo
  references:
  - https://github.com/spring-projects/spring-data-rest/commit/824e51a1304bbc8334ac0b96ffaef588177e6ccd
  - https://jira.spring.io/browse/DATAREST-1127
  - https://lgtm.com/blog/spring_data_rest_CVE-2017-8046
  - https://pivotal.io/security/cve-2017-8046
  - https://www.exploit-db.com/exploits/44289
  source_url: https://snyk.io/vuln/SNYK-JAVA-ORGSPRINGFRAMEWORKDATA-31577
