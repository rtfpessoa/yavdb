---
- id: snykio:maven:org.eclipse.jetty:jetty-serverAffected:575561
  title: Operation on a Resource after Expiration or Release
  description: |
    [org.eclipse.jetty:jetty-server][1] is a lightweight highly scalable
    java based web server and servlet engine.<span
    class="custom-package-name"><p>Affected</p></span> <span
    class="custom-affected-versions">9.4.27.v20200227 to 9.4.29.v20200521,
    in case of too large response headers, Jetty throws an exception to
    produce an HTTP 431 error. When this happens, the ByteBuffer containing
    the HTTP response headers is released back to the ByteBufferPool twice.
    Because of this double release, two threads can acquire the same
    ByteBuffer from the pool and while thread1 is about to use the
    ByteBuffer to write response1 data, thread2 fills the ByteBuffer with
    response2 data. Thread1 then proceeds to write the buffer that now
    contains response2 data. This results in client1, which issued request1
    and expects responses, to see response2 which could contain sensitive
    data belonging to client2 (HTTP session ids, authentication credentials,
    etc.).</span>



    [1]: https://mvnrepository.com/artifact/org.eclipse.jetty/jetty-server
  affected_package: org.eclipse.jetty:jetty-serverAffected
  vulnerable_versions:
  - "> HTTP session ids < authentication credentials"
  - ">= 9.4.27.v20200227 < 9.4.30.v20200611"
  severity: high
  package_manager: maven
  cve:
  - CVE-2019-17638
  cwe:
  - CWE-672
  disclosed_date: 2020-07-10
  created_date: 2020-07-10
  last_modified_date: 2020-07-10
  credit:
  - Unknown
  references:
  - https://bugs.eclipse.org/bugs/show_bug.cgi?id=564984
  - https://github.com/eclipse/jetty.project/commit/ff8ae56fa939c3477a0cdd1ff56ce3d902f08fba
  - https://github.com/eclipse/jetty.project/issues/4936
  source_url: https://snyk.io/vuln/SNYK-JAVA-ORGECLIPSEJETTY-575561
