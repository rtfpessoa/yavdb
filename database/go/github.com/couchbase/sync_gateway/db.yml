---
- id: snykio:go:github.com/couchbase/sync_gateway/db:451074
  title: N1QL injection
  description: |
    [github.com/couchbase/sync\_gateway/db][1] is a horizontally scalable
    web server that securely manages the access control and synchronization
    of data between Couchbase Lite and Couchbase Server.

    Affected versions of this package are vulnerable to N1QL injection. An
    attacker with access to the public REST API can insert additional N1QL
    statements through the parameters `startkey` and `endkey` of the
    `_all_docs` endpoint.



    [1]: https://github.com/couchbase/sync_gateway
  affected_package: github.com/couchbase/sync_gateway/db
  vulnerable_versions:
  - "<2.5"
  severity: medium
  package_manager: go
  cve:
  - CVE-2019-9039
  cwe:
  - CWE-89
  disclosed_date: 2019-06-26
  created_date: 2019-06-27
  last_modified_date: 2019-06-27
  credit:
  - Unknown
  references:
  - https://docs.couchbase.com/sync-gateway/2.5/release-notes.html
  - https://github.com/couchbase/sync_gateway/commit/97adb5b496aa96aa70398018ea96da913ffd8d8c
  - https://research.hisolutions.com/2019/06/n1ql-injection-in-couchbase-sync-gateway-cve-2019-9039/
  source_url: https://snyk.io/vuln/SNYK-GOLANG-GITHUBCOMCOUCHBASESYNCGATEWAYDB-451074
