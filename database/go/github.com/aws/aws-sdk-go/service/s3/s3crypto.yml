---
- id: snykio:go:github.com/aws/aws-sdk-go/service/s3/s3crypto:598252
  title: Use of a Broken or Risky Cryptographic Algorithm
  description: |
    [github.com/aws/aws-sdk-go/service/s3/s3crypto][1] is an AWS SDK for the
    Go programming language.

    Affected versions of this package are vulnerable to Use of a Broken or
    Risky Cryptographic Algorithm. A vulnerability in the in-band key
    negotiation exists in the AWS S3 Crypto SDK for GoLang versions prior to
    V2. An attacker with write access to the targeted bucket can change the
    encryption algorithm of an object in the bucket, which can then allow
    them to change AES-GCM to AES-CTR. Using this in combination with a
    decryption oracle can reveal the authentication key used by AES-GCM as
    decrypting the GMAC tag leaves the authentication key recoverable as an
    algebraic equation. It is recommended to update your SDK to V2 or later,
    and re-encrypt your files.



    [1]: http://github.com/aws/aws-sdk-go
  affected_package: github.com/aws/aws-sdk-go/service/s3/s3crypto
  vulnerable_versions:
  - "<1.34.2"
  severity: medium
  package_manager: go
  cve:
  - CVE-2020-8912
  cwe:
  - CWE-327
  disclosed_date: 2020-08-12
  created_date: 2020-08-12
  last_modified_date: 2020-08-12
  credit:
  - Sophie Schmieg
  references:
  - https://github.com/aws/aws-sdk-go/pull/3403
  - https://github.com/sophieschmieg/exploits/tree/master/aws_s3_crypto_poc
  source_url: https://snyk.io/vuln/SNYK-GOLANG-GITHUBCOMAWSAWSSDKGOSERVICES3S3CRYPTO-598252
- id: snykio:go:github.com/aws/aws-sdk-go/service/s3/s3crypto:598253
  title: Use of a Broken or Risky Cryptographic Algorithm
  description: |
    [github.com/aws/aws-sdk-go/service/s3/s3crypto][1] is an AWS SDK for the
    Go programming language.

    Affected versions of this package are vulnerable to Use of a Broken or
    Risky Cryptographic Algorithm. A padding oracle vulnerability exists in
    the AWS S3 Crypto SDK for GoLang versions prior to V2. The SDK allows
    users to encrypt files with AES-CBC without computing a Message
    Authentication Code (MAC), which then allows an attacker who has write
    access to the target\'s S3 bucket and can observe whether or not an
    endpoint with access to the key can decrypt a file, they can reconstruct
    the plaintext with (on average) 128\*length (plaintext) queries to the
    endpoint, by exploiting CBC\'s ability to manipulate the bytes of the
    next block and PKCS5 padding errors. It is recommended to update your
    SDK to V2 or later, and re-encrypt your files.



    [1]: http://github.com/aws/aws-sdk-go
  affected_package: github.com/aws/aws-sdk-go/service/s3/s3crypto
  vulnerable_versions:
  - "<1.34.2"
  severity: medium
  package_manager: go
  cve:
  - CVE-2020-8911
  cwe:
  - CWE-327
  disclosed_date: 2020-08-12
  created_date: 2020-08-12
  last_modified_date: 2020-08-12
  credit:
  - Sophie Schmieg
  references:
  - https://github.com/aws/aws-sdk-go/pull/3403
  - https://github.com/sophieschmieg/exploits/tree/master/aws_s3_crypto_poc
  source_url: https://snyk.io/vuln/SNYK-GOLANG-GITHUBCOMAWSAWSSDKGOSERVICES3S3CRYPTO-598253
