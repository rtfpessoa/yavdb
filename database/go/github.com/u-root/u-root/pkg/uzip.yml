---
- id: snykio:go:github.com/u-root/u-root/pkg/uzip:570441
  title: Arbitrary File Write via Archive Extraction (Zip Slip)
  description: "[github.com/u-root/u-root/pkg/uzip][1] is a package that provides
    Go\nversions of standard Linux tools and bootloaders. It also provides tools\nfor
    compiling Go programs in a single binary and creating initramfs\nimages.\n\nAffected
    versions of this package are vulnerable to Arbitrary File Write\nvia Archive Extraction
    (Zip Slip). It is vulnerable to both leading and\nnon-leading relative path traversal
    attacks in zip file extraction.\n\n### PoC by Georgios Gkitsas of Snyk Security
    Team   {#poc-by-georgios-gkitsas-of-snyk-security-team}\n\n    package main\n
    \   \n    import (\n        \"fmt\"\n        uzip \"github.com/u-root/u-root/pkg/uzip\"\n
    \   )\n    \n    \n    func main() {\n        file := \"relative.zip\"\n    \n
    \       err := uzip.FromZip(file, \".\")\n        if err != nil {\n        fmt.Println(err)\n
    \       }\n    }\n\nwith \\\"relative.zip\\\" being a zip archive that includes
    a file with\nfilepath that uses leading or non-leading \\\"../\\\" .\n\n\n\n[1]:
    https://github.com/u-root/u-root/\n\\nIt is exploited using a specially crafted
    zip archive, that holds path\ntraversal filenames. When exploited, a filename
    in a malicious archive\nis concatenated to the target extraction directory, which
    results in the\nfinal path ending up outside of the target folder. For instance,
    a zip\nmay hold a file with a \\\"../../file.exe\\\" location and thus break out
    of\nthe target folder. If an executable or a configuration file is\noverwritten
    with a file containing malicious code, the problem can turn\ninto an arbitrary
    code execution issue quite easily.\n\nThe following is an example of a zip archive
    with one benign file and\none malicious file. Extracting the malicous file will
    result in\ntraversing out of the target folder, ending up in `/root/.ssh/`\noverwriting
    the `authorized_keys` file:\n\n    \n    +2018-04-15 22:04:29 ..... 19 19 good.txt\n
    \   \n    +2018-04-15 22:04:42 ..... 20 20 ../../../../../../root/.ssh/authorized_keys\n\n"
  affected_package: github.com/u-root/u-root/pkg/uzip
  vulnerable_versions:
  - "*"
  severity: high
  package_manager: go
  cve:
  - CVE-2020-7665
  cwe:
  - CWE-22
  disclosed_date: 2020-09-01
  created_date: 2020-09-01
  last_modified_date: 2020-09-01
  credit:
  - Georgios Gkitsas of Snyk Security Team
  references:
  - https://github.com/u-root/u-root/pull/1817
  source_url: https://snyk.io/vuln/SNYK-GOLANG-GITHUBCOMUROOTUROOTPKGUZIP-570441
