---
- id: snykio:go:github.com/unknwon/cae/tz:570384
  title: Arbitrary File Write via Archive Extraction (Zip Slip)
  description: "[github.com/unknwon/cae/tz][1] is a package that provides archiving\nfunctionality
    for `.tar.gz` archives.\n\nAffected versions of this package are vulnerable to
    Arbitrary File Write\nvia Archive Extraction (Zip Slip). The `ExtractTo` function
    doesn\\'t\nsecurely escape file paths in zip archives which include leading or\nnon-leading
    \\\"..\\\". This allowed an attacker to add or replace files\nsystem-wide.\n\n###
    PoC by Georgios Gkitsas   {#poc-by-georgios-gkitsas}\n\n    package main\n    \n
    \   import (\n        cae_tz \"github.com/unknwon/cae/tz\"\n    )\n    \n    \n
    \   func main() {\n        file := \"relative.tar.gz\"\n        z, _ := cae_tz.Open(file)\n
    \       z.ExtractTo(\".\")\n    }\n\nwhere \\\"relative.tar.gz\\\" is a .tar.gz
    archive that includes a\nleading/non-leading \\\"..\\\" in at least one file path.\n\n\n\n[1]:
    https://github.com/unknwon/cae\n\\nIt is exploited using a specially crafted zip
    archive, that holds path\ntraversal filenames. When exploited, a filename in a
    malicious archive\nis concatenated to the target extraction directory, which results
    in the\nfinal path ending up outside of the target folder. For instance, a zip\nmay
    hold a file with a \\\"../../file.exe\\\" location and thus break out of\nthe
    target folder. If an executable or a configuration file is\noverwritten with a
    file containing malicious code, the problem can turn\ninto an arbitrary code execution
    issue quite easily.\n\nThe following is an example of a zip archive with one benign
    file and\none malicious file. Extracting the malicous file will result in\ntraversing
    out of the target folder, ending up in `/root/.ssh/`\noverwriting the `authorized_keys`
    file:\n\n    \n    +2018-04-15 22:04:29 ..... 19 19 good.txt\n    \n    +2018-04-15
    22:04:42 ..... 20 20 ../../../../../../root/.ssh/authorized_keys\n\n"
  affected_package: github.com/unknwon/cae/tz
  vulnerable_versions:
  - "*"
  severity: high
  package_manager: go
  cve:
  - CVE-2020-7668
  cwe:
  - CWE-22
  disclosed_date: 2020-05-26
  created_date: 2020-06-05
  last_modified_date: 2020-06-05
  credit:
  - Georgios Gkitsas of Snyk Security Team
  source_url: https://snyk.io/vuln/SNYK-GOLANG-GITHUBCOMUNKNWONCAETZ-570384
